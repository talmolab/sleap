

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>sleap.nn.tracking &#8212; SLEAP (v1.4.1a2)</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'api/sleap.nn.tracking';</script>
    <link rel="canonical" href="/develop/api/sleap.nn.tracking.html" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials/tutorial.html">Tutorial</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/new-project.html">Creating a project</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/initial-labeling.html">Initial Labeling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/initial-training.html">Training and Inference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/assisted-labeling.html">Prediction-assisted labeling</a></li>

<li class="toctree-l2"><a class="reference internal" href="../tutorials/proofreading.html">Tracking instances across frames</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/analysis.html">Export Data For Analysis</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../guides/index.html">Guides</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../guides/gui.html">GUI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/cli.html">Command line interfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/troubleshooting-workflows.html">Troubleshooting workflows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/skeletons.html">Skeleton design</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/choosing-models.html">Configuring models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/merging.html">Importing predictions for labeling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/proofreading.html">Tracking and proofreading</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/colab.html">Run training and inference on Colab</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/custom-training.html">Creating a custom training profile</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/remote.html">Running SLEAP remotely</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../notebooks/index.html">Notebooks</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/Training_and_inference_on_an_example_dataset.html">Training and inference on an example dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/Training_and_inference_using_Google_Drive.html">Training and inference on your own data using Google Drive</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/Model_evaluation.html">Model evaluation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/Analysis_examples.html">Analysis examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/Data_structures.html">Data structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/Post_inference_tracking.html">Post-inference tracking</a></li>



<li class="toctree-l2"><a class="reference internal" href="../notebooks/Interactive_and_resumable_training.html">Interactive and resumable training</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/Interactive_and_realtime_inference.html">Interactive and realtime inference</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api.html">Developer API</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../datasets.html">Datasets</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/talmolab/sleap">GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/talmolab/sleap/releases">Releases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../help.html">Help</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/talmolab/sleap" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/talmolab/sleap/issues/new?title=Issue%20on%20page%20%2Fapi/sleap.nn.tracking.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>

</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>sleap.nn.tracking</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="module-sleap.nn.tracking">
<span id="sleap-nn-tracking"></span><h1>sleap.nn.tracking<a class="headerlink" href="#module-sleap.nn.tracking" title="Permalink to this headline">#</a></h1>
<p>Tracking tools for linking grouped instances over time.</p>
<dl class="py class">
<dt class="sig sig-object py" id="sleap.nn.tracking.BaseTracker">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sleap.nn.tracking.</span></span><span class="sig-name descname"><span class="pre">BaseTracker</span></span><a class="reference external" href="https://github.com/talmolab/sleap/blob/v1.4.1a2/sleap/nn/tracking.py#L508-L535"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.tracking.BaseTracker" title="Permalink to this definition">#</a></dt>
<dd><p>Abstract base class for tracker.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sleap.nn.tracking.FlowCandidateMaker">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sleap.nn.tracking.</span></span><span class="sig-name descname"><span class="pre">FlowCandidateMaker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">min_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">of_window_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">21</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">of_max_levels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_shifted_instances</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">track_window</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shifted_instances</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">sleap.nn.tracking.ShiftedInstance</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">NOTHING</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/talmolab/sleap/blob/v1.4.1a2/sleap/nn/tracking.py#L108-L355"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.tracking.FlowCandidateMaker" title="Permalink to this definition">#</a></dt>
<dd><p>Class for producing optical flow shift matching candidates.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.tracking.FlowCandidateMaker.min_points">
<span class="sig-name descname"><span class="pre">min_points</span></span><a class="headerlink" href="#sleap.nn.tracking.FlowCandidateMaker.min_points" title="Permalink to this definition">#</a></dt>
<dd><p>Minimum number of points that must be detected in the new frame in
order to generate a new shifted instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.tracking.FlowCandidateMaker.img_scale">
<span class="sig-name descname"><span class="pre">img_scale</span></span><a class="headerlink" href="#sleap.nn.tracking.FlowCandidateMaker.img_scale" title="Permalink to this definition">#</a></dt>
<dd><p>Factor to scale the images by when computing optical flow. Decrease
this to increase performance at the cost of finer accuracy. Sometimes
decreasing the image scale can improve performance with fast movements.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.tracking.FlowCandidateMaker.of_window_size">
<span class="sig-name descname"><span class="pre">of_window_size</span></span><a class="headerlink" href="#sleap.nn.tracking.FlowCandidateMaker.of_window_size" title="Permalink to this definition">#</a></dt>
<dd><p>Optical flow window size to consider at each pyramid scale
level.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.tracking.FlowCandidateMaker.of_max_levels">
<span class="sig-name descname"><span class="pre">of_max_levels</span></span><a class="headerlink" href="#sleap.nn.tracking.FlowCandidateMaker.of_max_levels" title="Permalink to this definition">#</a></dt>
<dd><p>Number of pyramid scale levels to consider. This is different
from the scale parameter, which determines the initial image scaling.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.tracking.FlowCandidateMaker.save_shifted_instances">
<span class="sig-name descname"><span class="pre">save_shifted_instances</span></span><a class="headerlink" href="#sleap.nn.tracking.FlowCandidateMaker.save_shifted_instances" title="Permalink to this definition">#</a></dt>
<dd><p>If True, save the shifted instances between elapsed
frames.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.tracking.FlowCandidateMaker.track_window">
<span class="sig-name descname"><span class="pre">track_window</span></span><a class="headerlink" href="#sleap.nn.tracking.FlowCandidateMaker.track_window" title="Permalink to this definition">#</a></dt>
<dd><p>How many frames back to look for candidate instances to match
instances in the current frame against.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sleap.nn.tracking.FlowCandidateMaker.flow_shift_instances">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">flow_shift_instances</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ref_instances</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">sleap.nn.tracker.components.InstanceType</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_shifted_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">21</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_levels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">sleap.nn.tracking.ShiftedInstance</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/talmolab/sleap/blob/v1.4.1a2/sleap/nn/tracking.py#L253-L355"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.tracking.FlowCandidateMaker.flow_shift_instances" title="Permalink to this definition">#</a></dt>
<dd><p>Generates instances in a new frame by applying optical flow displacements.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ref_instances</strong> – Reference instances in the previous frame.</p></li>
<li><p><strong>ref_img</strong> – Previous frame image as a numpy array.</p></li>
<li><p><strong>new_img</strong> – New frame image as a numpy array.</p></li>
<li><p><strong>min_shifted_points</strong> – Minimum number of points that must be detected in the
new frame in order to generate a new shifted instance.</p></li>
<li><p><strong>scale</strong> – Factor to scale the images by when computing optical flow. Decrease
this to increase performance at the cost of finer accuracy. Sometimes
decreasing the image scale can improve performance with fast movements.</p></li>
<li><p><strong>window_size</strong> – Optical flow window size to consider at each pyramid scale
level.</p></li>
<li><p><strong>max_levels</strong> – Number of pyramid scale levels to consider. This is different
from the scale parameter, which determines the initial image scaling.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A list of ShiftedInstances with the optical flow displacements applied to
the reference instance points. Points that are not found will be represented
as NaNs in the points array for each shifted instance.</p>
</dd>
</dl>
<div class="admonition-notes admonition">
<p class="admonition-title">Notes</p>
<p>This function relies on the Lucas-Kanade method for optical flow estimation.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sleap.nn.tracking.FlowCandidateMaker.get_shifted_instances">
<span class="sig-name descname"><span class="pre">get_shifted_instances</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ref_instances</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">sleap.nn.tracker.components.InstanceType</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">sleap.nn.tracking.ShiftedInstance</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/talmolab/sleap/blob/v1.4.1a2/sleap/nn/tracking.py#L164-L201"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.tracking.FlowCandidateMaker.get_shifted_instances" title="Permalink to this definition">#</a></dt>
<dd><p>Returns a list of shifted instances and save shifted instances if needed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ref_instances</strong> – Reference instances in the previous frame.</p></li>
<li><p><strong>ref_img</strong> – Previous frame image as a numpy array.</p></li>
<li><p><strong>ref_t</strong> – Previous frame time instance.</p></li>
<li><p><strong>img</strong> – Current frame image as a numpy array.</p></li>
<li><p><strong>t</strong> – Current time instance.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sleap.nn.tracking.FlowCandidateMaker.get_shifted_instances_from_earlier_time">
<span class="sig-name descname"><span class="pre">get_shifted_instances_from_earlier_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">ref_t:</span> <span class="pre">int,</span> <span class="pre">ref_img:</span> <span class="pre">numpy.ndarray,</span> <span class="pre">ref_instances:</span> <span class="pre">typing.List[sleap.nn.tracker.components.InstanceType],</span> <span class="pre">t:</span> <span class="pre">int)</span> <span class="pre">-&gt;</span> <span class="pre">(&lt;class</span> <span class="pre">'numpy.ndarray'&gt;,</span> <span class="pre">typing.List[~InstanceType]</span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/talmolab/sleap/blob/v1.4.1a2/sleap/nn/tracking.py#L143-L162"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.tracking.FlowCandidateMaker.get_shifted_instances_from_earlier_time" title="Permalink to this definition">#</a></dt>
<dd><p>Generate shifted instances and corresponding image from earlier time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ref_instances</strong> – Reference instances in the previous frame.</p></li>
<li><p><strong>ref_img</strong> – Previous frame image as a numpy array.</p></li>
<li><p><strong>ref_t</strong> – Previous frame time instance.</p></li>
<li><p><strong>t</strong> – Current time instance.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sleap.nn.tracking.FlowCandidateMaker.prune_shifted_instances">
<span class="sig-name descname"><span class="pre">prune_shifted_instances</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/talmolab/sleap/blob/v1.4.1a2/sleap/nn/tracking.py#L234-L251"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.tracking.FlowCandidateMaker.prune_shifted_instances" title="Permalink to this definition">#</a></dt>
<dd><p>Prune the shifted instances older than <code class="xref py py-obj docutils literal notranslate"><span class="pre">self.track_window</span></code>.</p>
<p>If <code class="xref py py-obj docutils literal notranslate"><span class="pre">self.save_shifted_instances</span></code> is False, do nothing.</p>
<dl class="simple">
<dt>Args</dt><dd><dl class="simple">
<dt>t: reference instances from a frame number more than <code class="xref py py-obj docutils literal notranslate"><span class="pre">self.track_window</span></code> before</dt><dd><p>the current frame <code class="xref py py-obj docutils literal notranslate"><span class="pre">t</span></code> will be pruned from the <code class="xref py py-obj docutils literal notranslate"><span class="pre">self.shifted_instances</span></code> dict.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sleap.nn.tracking.FlowMaxTracker">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sleap.nn.tracking.</span></span><span class="sig-name descname"><span class="pre">FlowMaxTracker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_tracks:</span> <span class="pre">typing.Optional[int]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">track_window:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">similarity_function:</span> <span class="pre">typing.Optional[typing.Callable]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">instance_similarity&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matching_function:</span> <span class="pre">typing.Callable</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">greedy_matching&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">candidate_maker:</span> <span class="pre">object</span> <span class="pre">=</span> <span class="pre">NOTHING</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_tracking:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cleaner:</span> <span class="pre">typing.Optional[typing.Callable]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_instance_count:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_cull_function:</span> <span class="pre">typing.Optional[typing.Callable]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">post_connect_single_breaks:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">robust_best_instance:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_new_track_points:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">track_matching_queue:</span> <span class="pre">typing.Deque[sleap.nn.tracking.MatchedFrameInstances]</span> <span class="pre">=</span> <span class="pre">NOTHING</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">track_matching_queue_dict:</span> <span class="pre">typing.Dict[sleap.instance.Track</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">typing.Deque[sleap.nn.tracking.MatchedFrameInstance]]</span> <span class="pre">=</span> <span class="pre">NOTHING</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spawned_tracks:</span> <span class="pre">typing.List[sleap.instance.Track]</span> <span class="pre">=</span> <span class="pre">NOTHING</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_tracked_instances:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tracked_instances:</span> <span class="pre">typing.Dict[int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">typing.List[sleap.nn.tracker.components.InstanceType]]</span> <span class="pre">=</span> <span class="pre">NOTHING</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_matches:</span> <span class="pre">typing.Optional[sleap.nn.tracker.components.FrameMatches]</span> <span class="pre">=</span> <span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/talmolab/sleap/blob/v1.4.1a2/sleap/nn/tracking.py#L1162-L1169"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.tracking.FlowMaxTracker" title="Permalink to this definition">#</a></dt>
<dd><p>Pre-configured tracker to use optical flow shifted candidates with max tracks.</p>
<dl class="py method">
<dt class="sig sig-object py" id="sleap.nn.tracking.FlowMaxTracker.matching_function">
<span class="sig-name descname"><span class="pre">matching_function</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/talmolab/sleap/blob/v1.4.1a2/sleap/nn/tracker/components.py#L180-L201"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.tracking.FlowMaxTracker.matching_function" title="Permalink to this definition">#</a></dt>
<dd><p>Performs greedy bipartite matching.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sleap.nn.tracking.FlowMaxTracker.similarity_function">
<span class="sig-name descname"><span class="pre">similarity_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query_instance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">sleap.nn.tracker.components.InstanceType</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference external" href="https://github.com/talmolab/sleap/blob/v1.4.1a2/sleap/nn/tracker/components.py#L32-L43"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.tracking.FlowMaxTracker.similarity_function" title="Permalink to this definition">#</a></dt>
<dd><p>Computes similarity between instances.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sleap.nn.tracking.FlowMaxTracksCandidateMaker">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sleap.nn.tracking.</span></span><span class="sig-name descname"><span class="pre">FlowMaxTracksCandidateMaker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">min_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">of_window_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">21</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">of_max_levels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_shifted_instances</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">track_window</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shifted_instances</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">sleap.nn.tracking.ShiftedInstance</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">NOTHING</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_tracks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/talmolab/sleap/blob/v1.4.1a2/sleap/nn/tracking.py#L359-L436"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.tracking.FlowMaxTracksCandidateMaker" title="Permalink to this definition">#</a></dt>
<dd><p>Class for producing optical flow shift matching candidates with maximum tracks.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.tracking.FlowMaxTracksCandidateMaker.max_tracks">
<span class="sig-name descname"><span class="pre">max_tracks</span></span><a class="headerlink" href="#sleap.nn.tracking.FlowMaxTracksCandidateMaker.max_tracks" title="Permalink to this definition">#</a></dt>
<dd><p>The maximum number of tracks to avoid redundant tracks.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sleap.nn.tracking.FlowMaxTracksCandidateMaker.get_ref_instances">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_ref_instances</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ref_t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">track_matching_queue_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="sleap.instance.html#sleap.instance.Track" title="sleap.instance.Track"><span class="pre">sleap.instance.Track</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Deque</span><span class="p"><span class="pre">[</span></span><span class="pre">sleap.nn.tracking.MatchedFrameInstance</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">sleap.nn.tracker.components.InstanceType</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/talmolab/sleap/blob/v1.4.1a2/sleap/nn/tracking.py#L369-L390"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.tracking.FlowMaxTracksCandidateMaker.get_ref_instances" title="Permalink to this definition">#</a></dt>
<dd><p>Generates a list of instances based on the reference time and image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ref_t</strong> – Previous frame time instance.</p></li>
<li><p><strong>ref_img</strong> – Previous frame image as a numpy array.</p></li>
<li><p><strong>track_matching_queue_dict</strong> – A dictionary of mapping between the tracks
and the corresponding instances associated with the track.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sleap.nn.tracking.FlowTracker">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sleap.nn.tracking.</span></span><span class="sig-name descname"><span class="pre">FlowTracker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_tracks:</span> <span class="pre">typing.Optional[int]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">track_window:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_tracking:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cleaner:</span> <span class="pre">typing.Optional[typing.Callable]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_instance_count:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_cull_function:</span> <span class="pre">typing.Optional[typing.Callable]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">post_connect_single_breaks:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">robust_best_instance:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_new_track_points:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">track_matching_queue:</span> <span class="pre">typing.Deque[sleap.nn.tracking.MatchedFrameInstances]</span> <span class="pre">=</span> <span class="pre">NOTHING</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">track_matching_queue_dict:</span> <span class="pre">typing.Dict[sleap.instance.Track</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">typing.Deque[sleap.nn.tracking.MatchedFrameInstance]]</span> <span class="pre">=</span> <span class="pre">NOTHING</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spawned_tracks:</span> <span class="pre">typing.List[sleap.instance.Track]</span> <span class="pre">=</span> <span class="pre">NOTHING</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_tracked_instances:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tracked_instances:</span> <span class="pre">typing.Dict[int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">typing.List[sleap.nn.tracker.components.InstanceType]]</span> <span class="pre">=</span> <span class="pre">NOTHING</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_matches:</span> <span class="pre">typing.Optional[sleap.nn.tracker.components.FrameMatches]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">similarity_function:</span> <span class="pre">typing.Callable</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">instance_similarity&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matching_function:</span> <span class="pre">typing.Callable</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">greedy_matching&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">candidate_maker:</span> <span class="pre">object</span> <span class="pre">=</span> <span class="pre">NOTHING</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/talmolab/sleap/blob/v1.4.1a2/sleap/nn/tracking.py#L1151-L1156"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.tracking.FlowTracker" title="Permalink to this definition">#</a></dt>
<dd><p>A Tracker pre-configured to use optical flow shifted candidates.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sleap.nn.tracking.KalmanTracker">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sleap.nn.tracking.</span></span><span class="sig-name descname"><span class="pre">KalmanTracker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">init_tracker</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#sleap.nn.tracking.Tracker" title="sleap.nn.tracking.Tracker"><span class="pre">sleap.nn.tracking.Tracker</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_set</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">sleap.nn.tracking.KalmanInitSet</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kalman_tracker</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">sleap.nn.tracker.kalman.BareKalmanTracker</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cull_function</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_frame_count</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">re_init_cooldown</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">re_init_after</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_done</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_tracked</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_init_t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/talmolab/sleap/blob/v1.4.1a2/sleap/nn/tracking.py#L1269-L1462"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.tracking.KalmanTracker" title="Permalink to this definition">#</a></dt>
<dd><p>Class for Kalman filter-based tracking pipeline.</p>
<p>Kalman filters need to be initialized with a certain number of already
tracked instances.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init_tracker</strong> – The regular Tracker we can use to track data needed
for initializing Kalman filters. If not specified, then you can
use pre-tracked data (i.e., track assignments already set on
instances) if <code class="xref py py-obj docutils literal notranslate"><span class="pre">pre_tracked</span></code> is True.</p></li>
<li><p><strong>init_set</strong> – Object to keep track of tracked “init” data and determine
when we have enough good data to initialize filters.</p></li>
<li><p><strong>kalman_tracker</strong> – The object which handles the actual Kalman filter-based
tracking.</p></li>
<li><p><strong>cull_function</strong> – If given, this is called to cull instances before tracking.</p></li>
<li><p><strong>init_frame_count</strong> – The target number of instances/identities per frame.</p></li>
<li><p><strong>re_init_cooldown</strong> – Number of frames to wait after initializing filters
before checking if we need to re-init (because they aren’t
successfully matching tracks).</p></li>
<li><p><strong>re_init_after</strong> – If there’s a gap of this many frames since filters
have matched tracks (and we’ve also waited for cooldown frames),
start using the regular tracker so that we can re-initialize
Kalman filters.</p></li>
<li><p><strong>init_done</strong> – Keeps track of whether we’re initialized the filters yet.</p></li>
<li><p><strong>pre_tracked</strong> – Whether to use <code class="xref py py-obj docutils literal notranslate"><span class="pre">init_tracker</span></code> or tracks already set
on instances.</p></li>
<li><p><strong>last_t</strong> – The last frame index we’ve tracked.</p></li>
<li><p><strong>last_init_t</strong> – The last frame index on which Kalman filters were
initialized; used to checking cooldown period.</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="sleap.nn.tracking.KalmanTracker.is_valid">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_valid</span></span><a class="headerlink" href="#sleap.nn.tracking.KalmanTracker.is_valid" title="Permalink to this definition">#</a></dt>
<dd><p>Do we have everything we need to run tracking?</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sleap.nn.tracking.KalmanTracker.make_tracker">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">make_tracker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">init_tracker</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#sleap.nn.tracking.Tracker" title="sleap.nn.tracking.Tracker"><span class="pre">sleap.nn.tracking.Tracker</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_indices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">instance_count</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">instance_iou_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_frame_count</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/talmolab/sleap/blob/v1.4.1a2/sleap/nn/tracking.py#L1321-L1372"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.tracking.KalmanTracker.make_tracker" title="Permalink to this definition">#</a></dt>
<dd><p>Creates KalmanTracker object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init_tracker</strong> – The Kalman filters need to be initialized with data
that’s already been tracked. This is a regular Tracker which
can be used to generate this tracked data (when needed).</p></li>
<li><p><strong>node_indices</strong> – Which nodes to track using Kalman filters; these
should be nodes that are reliably present in the predictions.</p></li>
<li><p><strong>instance_count</strong> – The target number of instances to track per frame.
A distinct Kalman filter is created/initialized to track each
distinct identity. We’ll also use this to cull the number of
predicted instances before trying to track.</p></li>
<li><p><strong>instance_iou_threshold</strong> – This is the IOU threshold so that we first
cull instances which have high overlap.</p></li>
<li><p><strong>init_frame_count</strong> – How many frames of tracked data to use when
initializing Kalman filters.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sleap.nn.tracking.KalmanTracker.track">
<span class="sig-name descname"><span class="pre">track</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">untracked_instances</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">sleap.nn.tracker.components.InstanceType</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">sleap.nn.tracker.components.InstanceType</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/talmolab/sleap/blob/v1.4.1a2/sleap/nn/tracking.py#L1374-L1452"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.tracking.KalmanTracker.track" title="Permalink to this definition">#</a></dt>
<dd><p>Tracks individual frame, using Kalman filters if possible.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sleap.nn.tracking.SimpleCandidateMaker">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sleap.nn.tracking.</span></span><span class="sig-name descname"><span class="pre">SimpleCandidateMaker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">min_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/talmolab/sleap/blob/v1.4.1a2/sleap/nn/tracking.py#L440-L459"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.tracking.SimpleCandidateMaker" title="Permalink to this definition">#</a></dt>
<dd><p>Class for producing list of matching candidates from prior frames.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sleap.nn.tracking.SimpleMaxTracker">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sleap.nn.tracking.</span></span><span class="sig-name descname"><span class="pre">SimpleMaxTracker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">track_window:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cleaner:</span> <span class="pre">typing.Optional[typing.Callable]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_instance_count:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_cull_function:</span> <span class="pre">typing.Optional[typing.Callable]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">post_connect_single_breaks:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">robust_best_instance:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_new_track_points:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">track_matching_queue:</span> <span class="pre">typing.Deque[sleap.nn.tracking.MatchedFrameInstances]</span> <span class="pre">=</span> <span class="pre">NOTHING</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">track_matching_queue_dict:</span> <span class="pre">typing.Dict[sleap.instance.Track</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">typing.Deque[sleap.nn.tracking.MatchedFrameInstance]]</span> <span class="pre">=</span> <span class="pre">NOTHING</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spawned_tracks:</span> <span class="pre">typing.List[sleap.instance.Track]</span> <span class="pre">=</span> <span class="pre">NOTHING</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_tracked_instances:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tracked_instances:</span> <span class="pre">typing.Dict[int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">typing.List[sleap.nn.tracker.components.InstanceType]]</span> <span class="pre">=</span> <span class="pre">NOTHING</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_matches:</span> <span class="pre">typing.Optional[sleap.nn.tracker.components.FrameMatches]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">similarity_function:</span> <span class="pre">typing.Callable</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">instance_iou&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matching_function:</span> <span class="pre">typing.Callable</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">hungarian_matching&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">candidate_maker:</span> <span class="pre">object</span> <span class="pre">=</span> <span class="pre">NOTHING</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_tracking:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_tracks:</span> <span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/talmolab/sleap/blob/v1.4.1a2/sleap/nn/tracking.py#L1182-L1189"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.tracking.SimpleMaxTracker" title="Permalink to this definition">#</a></dt>
<dd><p>Pre-configured tracker to use simple, non-image-based candidates with max tracks.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sleap.nn.tracking.SimpleMaxTracksCandidateMaker">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sleap.nn.tracking.</span></span><span class="sig-name descname"><span class="pre">SimpleMaxTracksCandidateMaker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">min_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_tracks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/talmolab/sleap/blob/v1.4.1a2/sleap/nn/tracking.py#L463-L484"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.tracking.SimpleMaxTracksCandidateMaker" title="Permalink to this definition">#</a></dt>
<dd><p>Class to generate instances with maximum number of tracks from prior frames.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sleap.nn.tracking.SimpleTracker">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sleap.nn.tracking.</span></span><span class="sig-name descname"><span class="pre">SimpleTracker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_tracks:</span> <span class="pre">typing.Optional[int]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">track_window:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_tracking:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cleaner:</span> <span class="pre">typing.Optional[typing.Callable]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_instance_count:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_cull_function:</span> <span class="pre">typing.Optional[typing.Callable]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">post_connect_single_breaks:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">robust_best_instance:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_new_track_points:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">track_matching_queue:</span> <span class="pre">typing.Deque[sleap.nn.tracking.MatchedFrameInstances]</span> <span class="pre">=</span> <span class="pre">NOTHING</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">track_matching_queue_dict:</span> <span class="pre">typing.Dict[sleap.instance.Track</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">typing.Deque[sleap.nn.tracking.MatchedFrameInstance]]</span> <span class="pre">=</span> <span class="pre">NOTHING</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spawned_tracks:</span> <span class="pre">typing.List[sleap.instance.Track]</span> <span class="pre">=</span> <span class="pre">NOTHING</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_tracked_instances:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tracked_instances:</span> <span class="pre">typing.Dict[int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">typing.List[sleap.nn.tracker.components.InstanceType]]</span> <span class="pre">=</span> <span class="pre">NOTHING</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_matches:</span> <span class="pre">typing.Optional[sleap.nn.tracker.components.FrameMatches]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">similarity_function:</span> <span class="pre">typing.Callable</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">instance_iou&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matching_function:</span> <span class="pre">typing.Callable</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">hungarian_matching&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">candidate_maker:</span> <span class="pre">object</span> <span class="pre">=</span> <span class="pre">NOTHING</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/talmolab/sleap/blob/v1.4.1a2/sleap/nn/tracking.py#L1173-L1178"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.tracking.SimpleTracker" title="Permalink to this definition">#</a></dt>
<dd><p>A Tracker pre-configured to use simple, non-image-based candidates.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sleap.nn.tracking.TrackCleaner">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sleap.nn.tracking.</span></span><span class="sig-name descname"><span class="pre">TrackCleaner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">instance_count</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iou_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/talmolab/sleap/blob/v1.4.1a2/sleap/nn/tracking.py#L1466-L1491"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.tracking.TrackCleaner" title="Permalink to this definition">#</a></dt>
<dd><p>Class for merging breaks in the predicted tracks.</p>
<p>Method:
1. You specify how many instances there should be in each frame.
2. The lowest scoring instances beyond this limit are deleting from each frame.
3. Going frame by frame, any time there’s exactly one missing track and exactly</p>
<blockquote>
<div><p>one new track, we merge the new track into the missing track.</p>
</div></blockquote>
<p>You should review the results to check for “swaps”. This can be done using the
velocity threshold suggestion method.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.tracking.TrackCleaner.instance_count">
<span class="sig-name descname"><span class="pre">instance_count</span></span><a class="headerlink" href="#sleap.nn.tracking.TrackCleaner.instance_count" title="Permalink to this definition">#</a></dt>
<dd><p>The maximum number of instances we want per frame.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.tracking.TrackCleaner.iou_threshold">
<span class="sig-name descname"><span class="pre">iou_threshold</span></span><a class="headerlink" href="#sleap.nn.tracking.TrackCleaner.iou_threshold" title="Permalink to this definition">#</a></dt>
<dd><p>Intersection over Union (IOU) threshold to use when
removing overlapping instances over target count; if None, then
only use score to determine which instances to remove.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Optional[float]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sleap.nn.tracking.Tracker">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sleap.nn.tracking.</span></span><span class="sig-name descname"><span class="pre">Tracker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_tracks:</span> <span class="pre">typing.Optional[int]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">track_window:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">similarity_function:</span> <span class="pre">typing.Optional[typing.Callable]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">instance_similarity&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matching_function:</span> <span class="pre">typing.Callable</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">greedy_matching&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">candidate_maker:</span> <span class="pre">object</span> <span class="pre">=</span> <span class="pre">NOTHING</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_tracking:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cleaner:</span> <span class="pre">typing.Optional[typing.Callable]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_instance_count:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_cull_function:</span> <span class="pre">typing.Optional[typing.Callable]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">post_connect_single_breaks:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">robust_best_instance:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_new_track_points:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">track_matching_queue:</span> <span class="pre">typing.Deque[sleap.nn.tracking.MatchedFrameInstances]</span> <span class="pre">=</span> <span class="pre">NOTHING</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">track_matching_queue_dict:</span> <span class="pre">typing.Dict[sleap.instance.Track</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">typing.Deque[sleap.nn.tracking.MatchedFrameInstance]]</span> <span class="pre">=</span> <span class="pre">NOTHING</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spawned_tracks:</span> <span class="pre">typing.List[sleap.instance.Track]</span> <span class="pre">=</span> <span class="pre">NOTHING</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_tracked_instances:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tracked_instances:</span> <span class="pre">typing.Dict[int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">typing.List[sleap.nn.tracker.components.InstanceType]]</span> <span class="pre">=</span> <span class="pre">NOTHING</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_matches:</span> <span class="pre">typing.Optional[sleap.nn.tracker.components.FrameMatches]</span> <span class="pre">=</span> <span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/talmolab/sleap/blob/v1.4.1a2/sleap/nn/tracking.py#L539-L1147"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.tracking.Tracker" title="Permalink to this definition">#</a></dt>
<dd><p>Instance pose tracker.</p>
<p>Use by instantiated with the desired parameters and then calling the
<a class="reference internal" href="#sleap.nn.tracking.Tracker.track" title="sleap.nn.tracking.Tracker.track"><code class="xref py py-obj docutils literal notranslate"><span class="pre">track</span></code></a> method for each frame.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.tracking.Tracker.track_window">
<span class="sig-name descname"><span class="pre">track_window</span></span><a class="headerlink" href="#sleap.nn.tracking.Tracker.track_window" title="Permalink to this definition">#</a></dt>
<dd><p>How many frames back to look for candidate instances to
match instances in the current frame against.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.tracking.Tracker.similarity_function">
<span class="sig-name descname"><span class="pre">similarity_function</span></span><a class="headerlink" href="#sleap.nn.tracking.Tracker.similarity_function" title="Permalink to this definition">#</a></dt>
<dd><p>A function that returns a numeric pairwise
instance similarity value.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Optional[Callable]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.tracking.Tracker.matching_function">
<span class="sig-name descname"><span class="pre">matching_function</span></span><a class="headerlink" href="#sleap.nn.tracking.Tracker.matching_function" title="Permalink to this definition">#</a></dt>
<dd><p>A function that takes a matrix of pairwise similarities
and determines the matches to use.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Callable</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.tracking.Tracker.candidate_maker">
<span class="sig-name descname"><span class="pre">candidate_maker</span></span><a class="headerlink" href="#sleap.nn.tracking.Tracker.candidate_maker" title="Permalink to this definition">#</a></dt>
<dd><p>A class instance with a <code class="xref py py-obj docutils literal notranslate"><span class="pre">get_candidates</span></code> method
which returns a list of Instances-like objects  which we can match
the predicted instances in a frame against.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.tracking.Tracker.cleaner">
<span class="sig-name descname"><span class="pre">cleaner</span></span><a class="headerlink" href="#sleap.nn.tracking.Tracker.cleaner" title="Permalink to this definition">#</a></dt>
<dd><p>A class with a <code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code> method which attempts to clean tracks
after the other tracking has run for all frames.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Optional[Callable]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.tracking.Tracker.min_new_track_points">
<span class="sig-name descname"><span class="pre">min_new_track_points</span></span><a class="headerlink" href="#sleap.nn.tracking.Tracker.min_new_track_points" title="Permalink to this definition">#</a></dt>
<dd><p>We won’t spawn a new track for an instance with
fewer than this many points.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.tracking.Tracker.robust_best_instance">
<span class="sig-name descname"><span class="pre">robust_best_instance</span></span><a class="headerlink" href="#sleap.nn.tracking.Tracker.robust_best_instance" title="Permalink to this definition">#</a></dt>
<dd><p>if the value is between 0 and 1 (excluded),
use a robust quantile similarity score for the track. If the value is 1,
use the max similarity (non-robust). For selecting a robust score,
0.95 is a good value.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.tracking.Tracker.max_tracking">
<span class="sig-name descname"><span class="pre">max_tracking</span></span><a class="headerlink" href="#sleap.nn.tracking.Tracker.max_tracking" title="Permalink to this definition">#</a></dt>
<dd><p>Max tracking is incorporated when this is set to true.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sleap.nn.tracking.Tracker.final_pass">
<span class="sig-name descname"><span class="pre">final_pass</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frames</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="sleap.instance.html#sleap.instance.LabeledFrame" title="sleap.instance.LabeledFrame"><span class="pre">sleap.instance.LabeledFrame</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/talmolab/sleap/blob/v1.4.1a2/sleap/nn/tracking.py#L806-L818"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.tracking.Tracker.final_pass" title="Permalink to this definition">#</a></dt>
<dd><p>Called after tracking has run on all frames to do any post-processing.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sleap.nn.tracking.Tracker.track">
<span class="sig-name descname"><span class="pre">track</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">untracked_instances</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">sleap.nn.tracker.components.InstanceType</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">sleap.nn.tracker.components.InstanceType</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/talmolab/sleap/blob/v1.4.1a2/sleap/nn/tracking.py#L639-L763"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.tracking.Tracker.track" title="Permalink to this definition">#</a></dt>
<dd><p>Performs a single step of tracking.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>untracked_instances</strong> – List of instances to assign to tracks.</p></li>
<li><p><strong>img</strong> – Image data of the current frame for flow shifting.</p></li>
<li><p><strong>t</strong> – Current timestep. If not provided, increments from the internal queue.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A list of the instances that were tracked.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sleap.nn.tracking.Tracker.unique_tracks_in_queue">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">unique_tracks_in_queue</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="sleap.instance.html#sleap.instance.Track" title="sleap.instance.Track"><span class="pre">sleap.instance.Track</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#sleap.nn.tracking.Tracker.unique_tracks_in_queue" title="Permalink to this definition">#</a></dt>
<dd><p>Returns the unique tracks in the matching queue.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sleap.nn.tracking.run_tracker">
<span class="sig-prename descclassname"><span class="pre">sleap.nn.tracking.</span></span><span class="sig-name descname"><span class="pre">run_tracker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frames</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="sleap.instance.html#sleap.instance.LabeledFrame" title="sleap.instance.LabeledFrame"><span class="pre">sleap.instance.LabeledFrame</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tracker</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#sleap.nn.tracking.BaseTracker" title="sleap.nn.tracking.BaseTracker"><span class="pre">sleap.nn.tracking.BaseTracker</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="sleap.instance.html#sleap.instance.LabeledFrame" title="sleap.instance.LabeledFrame"><span class="pre">sleap.instance.LabeledFrame</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/talmolab/sleap/blob/v1.4.1a2/sleap/nn/tracking.py#L1494-L1531"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.tracking.run_tracker" title="Permalink to this definition">#</a></dt>
<dd><p>Run a tracker on a set of labeled frames.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>frames</strong> – A list of labeled frames with instances.</p></li>
<li><p><strong>tracker</strong> – An initialized Tracker.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The input frames with the new tracks assigned. If the frames already had tracks,
they will be cleared if the tracker has been re-initialized.</p>
</dd>
</dl>
</dd></dl>

</section>


                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By SLEAP Developers
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2019–2024, Talmo Lab.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>