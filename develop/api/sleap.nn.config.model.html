

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>sleap.nn.config.model &#8212; SLEAP (v1.3.3)</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'api/sleap.nn.config.model';</script>
    <link rel="canonical" href="/develop/api/sleap.nn.config.model.html" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials/tutorial.html">Tutorial</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/new-project.html">Creating a project</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/initial-labeling.html">Initial Labeling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/initial-training.html">Training and Inference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/assisted-labeling.html">Prediction-assisted labeling</a></li>

<li class="toctree-l2"><a class="reference internal" href="../tutorials/proofreading.html">Tracking instances across frames</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/analysis.html">Export Data For Analysis</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../guides/index.html">Guides</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../guides/gui.html">GUI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/cli.html">Command line interfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/troubleshooting-workflows.html">Troubleshooting workflows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/skeletons.html">Skeleton design</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/choosing-models.html">Configuring models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/merging.html">Importing predictions for labeling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/proofreading.html">Tracking and proofreading</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/colab.html">Run training and inference on Colab</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/custom-training.html">Creating a custom training profile</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/remote.html">Running SLEAP remotely</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/bonsai.html">Using Bonsai with SLEAP’</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../notebooks/index.html">Notebooks</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/Training_and_inference_on_an_example_dataset.html">Training and inference on an example dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/Training_and_inference_using_Google_Drive.html">Training and inference on your own data using Google Drive</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/Model_evaluation.html">Model evaluation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/Analysis_examples.html">Analysis examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/Data_structures.html">Data structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/Post_inference_tracking.html">Post-inference tracking</a></li>



<li class="toctree-l2"><a class="reference internal" href="../notebooks/Interactive_and_resumable_training.html">Interactive and resumable training</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/Interactive_and_realtime_inference.html">Interactive and realtime inference</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api.html">Developer API</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../datasets.html">Datasets</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/talmolab/sleap">GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/talmolab/sleap/releases">Releases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../help.html">Help</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/talmolab/sleap" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/talmolab/sleap/issues/new?title=Issue%20on%20page%20%2Fapi/sleap.nn.config.model.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>

</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>sleap.nn.config.model</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="module-sleap.nn.config.model">
<span id="sleap-nn-config-model"></span><h1>sleap.nn.config.model<a class="headerlink" href="#module-sleap.nn.config.model" title="Permalink to this headline">#</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="sleap.nn.config.model.BackboneConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sleap.nn.config.model.</span></span><span class="sig-name descname"><span class="pre">BackboneConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/talmolab/sleap/blob/v1.3.3/sleap/nn/config/model.py#L630-L646"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.config.model.BackboneConfig" title="Permalink to this definition">#</a></dt>
<dd><p>Configurations related to the model backbone.</p>
<p>Only one field can be set and will determine which backbone architecture to use.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.BackboneConfig.leap">
<span class="sig-name descname"><span class="pre">leap</span></span><a class="headerlink" href="#sleap.nn.config.model.BackboneConfig.leap" title="Permalink to this definition">#</a></dt>
<dd><p>A <a class="reference internal" href="#sleap.nn.config.model.LEAPConfig" title="sleap.nn.config.model.LEAPConfig"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LEAPConfig</span></code></a> instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Optional[<a class="reference internal" href="#sleap.nn.config.model.LEAPConfig" title="sleap.nn.config.model.LEAPConfig">sleap.nn.config.model.LEAPConfig</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.BackboneConfig.unet">
<span class="sig-name descname"><span class="pre">unet</span></span><a class="headerlink" href="#sleap.nn.config.model.BackboneConfig.unet" title="Permalink to this definition">#</a></dt>
<dd><p>A <a class="reference internal" href="#sleap.nn.config.model.UNetConfig" title="sleap.nn.config.model.UNetConfig"><code class="xref py py-obj docutils literal notranslate"><span class="pre">UNetConfig</span></code></a> instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Optional[<a class="reference internal" href="#sleap.nn.config.model.UNetConfig" title="sleap.nn.config.model.UNetConfig">sleap.nn.config.model.UNetConfig</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.BackboneConfig.hourglass">
<span class="sig-name descname"><span class="pre">hourglass</span></span><a class="headerlink" href="#sleap.nn.config.model.BackboneConfig.hourglass" title="Permalink to this definition">#</a></dt>
<dd><p>A <a class="reference internal" href="#sleap.nn.config.model.HourglassConfig" title="sleap.nn.config.model.HourglassConfig"><code class="xref py py-obj docutils literal notranslate"><span class="pre">HourglassConfig</span></code></a> instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Optional[<a class="reference internal" href="#sleap.nn.config.model.HourglassConfig" title="sleap.nn.config.model.HourglassConfig">sleap.nn.config.model.HourglassConfig</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.BackboneConfig.resnet">
<span class="sig-name descname"><span class="pre">resnet</span></span><a class="headerlink" href="#sleap.nn.config.model.BackboneConfig.resnet" title="Permalink to this definition">#</a></dt>
<dd><p>A <a class="reference internal" href="#sleap.nn.config.model.ResNetConfig" title="sleap.nn.config.model.ResNetConfig"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ResNetConfig</span></code></a> instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Optional[<a class="reference internal" href="#sleap.nn.config.model.ResNetConfig" title="sleap.nn.config.model.ResNetConfig">sleap.nn.config.model.ResNetConfig</a>]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sleap.nn.config.model.CenteredInstanceConfmapsHeadConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sleap.nn.config.model.</span></span><span class="sig-name descname"><span class="pre">CenteredInstanceConfmapsHeadConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">anchor_part</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">part_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset_refinement</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/talmolab/sleap/blob/v1.3.3/sleap/nn/config/model.py#L99-L157"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.config.model.CenteredInstanceConfmapsHeadConfig" title="Permalink to this definition">#</a></dt>
<dd><p>Configurations for centered instance confidence map heads.</p>
<p>These heads are used in topdown multi-instance models that make the assumption that
there is an instance reliably centered in the cropped input image. These heads are
useful when centroids are easy to detect as they learn complex relationships between
the geometry of body parts, even when animals are occluded.</p>
<p>This comes at the cost of a strong reliance on the accuracy of the instance-centered
cropping, i.e., it is heavily limited by the accuracy of the centroid model.</p>
<p>Additionally, since one image crop is evaluated per instance, topdown models scale
linearly with the number of animals in the frame, which can result in poor
performance when many instances are present.</p>
<p>Use this head when centroids are easy to detect, preferably using a consistent body
part as an anchor, and when there are few animals that cover a small region of the
full frame.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.CenteredInstanceConfmapsHeadConfig.anchor_part">
<span class="sig-name descname"><span class="pre">anchor_part</span></span><a class="headerlink" href="#sleap.nn.config.model.CenteredInstanceConfmapsHeadConfig.anchor_part" title="Permalink to this definition">#</a></dt>
<dd><p>Text name of a body part (node) to use as the anchor point. If
None, the midpoint of the bounding box of all visible instance points will
be used as the anchor. The bounding box midpoint will also be used if the
anchor part is specified but not visible in the instance. Setting a reliable
anchor point can significantly improve topdown model accuracy as they
benefit from a consistent geometry of the body parts relative to the center
of the image.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Optional[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.CenteredInstanceConfmapsHeadConfig.part_names">
<span class="sig-name descname"><span class="pre">part_names</span></span><a class="headerlink" href="#sleap.nn.config.model.CenteredInstanceConfmapsHeadConfig.part_names" title="Permalink to this definition">#</a></dt>
<dd><p>Text name of the body parts (nodes) that the head will be configured
to produce. The number of parts determines the number of channels in the
output. If not specified, all body parts in the skeleton will be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Optional[List[str]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.CenteredInstanceConfmapsHeadConfig.sigma">
<span class="sig-name descname"><span class="pre">sigma</span></span><a class="headerlink" href="#sleap.nn.config.model.CenteredInstanceConfmapsHeadConfig.sigma" title="Permalink to this definition">#</a></dt>
<dd><p>Spread of the Gaussian distribution of the confidence maps as a scalar
float. Smaller values are more precise but may be difficult to learn as they
have a lower density within the image space. Larger values are easier to
learn but are less precise with respect to the peak coordinate. This spread
is in units of pixels of the model input image, i.e., the image resolution
after any input scaling is applied.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.CenteredInstanceConfmapsHeadConfig.output_stride">
<span class="sig-name descname"><span class="pre">output_stride</span></span><a class="headerlink" href="#sleap.nn.config.model.CenteredInstanceConfmapsHeadConfig.output_stride" title="Permalink to this definition">#</a></dt>
<dd><p>The stride of the output confidence maps relative to the input
image. This is the reciprocal of the resolution, e.g., an output stride of 2
results in confidence maps that are 0.5x the size of the input. Increasing
this value can considerably speed up model performance and decrease memory
requirements, at the cost of decreased spatial resolution.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.CenteredInstanceConfmapsHeadConfig.loss_weight">
<span class="sig-name descname"><span class="pre">loss_weight</span></span><a class="headerlink" href="#sleap.nn.config.model.CenteredInstanceConfmapsHeadConfig.loss_weight" title="Permalink to this definition">#</a></dt>
<dd><p>Scalar float used to weigh the loss term for this head during
training. Increase this to encourage the optimization to focus on improving
this specific output in multi-head models.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.CenteredInstanceConfmapsHeadConfig.offset_refinement">
<span class="sig-name descname"><span class="pre">offset_refinement</span></span><a class="headerlink" href="#sleap.nn.config.model.CenteredInstanceConfmapsHeadConfig.offset_refinement" title="Permalink to this definition">#</a></dt>
<dd><p>If <code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code>, model will also output an offset refinement map
used to achieve subpixel localization of peaks during inference. This can
improve the localization accuracy of the model at the cost of additional
memory and training and inference time. If <code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code> (the default), subpixel
localization can be achieved post-hoc with deterministic refinement, which
does not require additional resources or training, but may not achieve the
same accuracy as learned refinement.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sleap.nn.config.model.CentroidsHeadConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sleap.nn.config.model.</span></span><span class="sig-name descname"><span class="pre">CentroidsHeadConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">anchor_part</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset_refinement</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/talmolab/sleap/blob/v1.3.3/sleap/nn/config/model.py#L51-L95"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.config.model.CentroidsHeadConfig" title="Permalink to this definition">#</a></dt>
<dd><p>Configurations for centroid confidence map heads.</p>
<p>These heads are used in topdown models that rely on centroid detection to detect
instances for cropping before predicting the remaining body parts.</p>
<p>Multiple centroids can be present (one per instance), so their coordinates can be
recovered in inference via local peak finding.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.CentroidsHeadConfig.anchor_part">
<span class="sig-name descname"><span class="pre">anchor_part</span></span><a class="headerlink" href="#sleap.nn.config.model.CentroidsHeadConfig.anchor_part" title="Permalink to this definition">#</a></dt>
<dd><p>Text name of a body part (node) to use as the anchor point. If
None, the midpoint of the bounding box of all visible instance points will
be used as the anchor. The bounding box midpoint will also be used if the
anchor part is specified but not visible in the instance. Setting a reliable
anchor point can significantly improve topdown model accuracy as they
benefit from a consistent geometry of the body parts relative to the center
of the image.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Optional[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.CentroidsHeadConfig.sigma">
<span class="sig-name descname"><span class="pre">sigma</span></span><a class="headerlink" href="#sleap.nn.config.model.CentroidsHeadConfig.sigma" title="Permalink to this definition">#</a></dt>
<dd><p>Spread of the Gaussian distribution of the confidence maps as a scalar
float. Smaller values are more precise but may be difficult to learn as they
have a lower density within the image space. Larger values are easier to
learn but are less precise with respect to the peak coordinate. This spread
is in units of pixels of the model input image, i.e., the image resolution
after any input scaling is applied.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.CentroidsHeadConfig.output_stride">
<span class="sig-name descname"><span class="pre">output_stride</span></span><a class="headerlink" href="#sleap.nn.config.model.CentroidsHeadConfig.output_stride" title="Permalink to this definition">#</a></dt>
<dd><p>The stride of the output confidence maps relative to the input
image. This is the reciprocal of the resolution, e.g., an output stride of 2
results in confidence maps that are 0.5x the size of the input. Increasing
this value can considerably speed up model performance and decrease memory
requirements, at the cost of decreased spatial resolution.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.CentroidsHeadConfig.loss_weight">
<span class="sig-name descname"><span class="pre">loss_weight</span></span><a class="headerlink" href="#sleap.nn.config.model.CentroidsHeadConfig.loss_weight" title="Permalink to this definition">#</a></dt>
<dd><p>Scalar float used to weigh the loss term for this head during
training. Increase this to encourage the optimization to focus on improving
this specific output in multi-head models.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.CentroidsHeadConfig.offset_refinement">
<span class="sig-name descname"><span class="pre">offset_refinement</span></span><a class="headerlink" href="#sleap.nn.config.model.CentroidsHeadConfig.offset_refinement" title="Permalink to this definition">#</a></dt>
<dd><p>If <code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code>, model will also output an offset refinement map
used to achieve subpixel localization of peaks during inference. This can
improve the localization accuracy of the model at the cost of additional
memory and training and inference time. If <code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code> (the default), subpixel
localization can be achieved post-hoc with deterministic refinement, which
does not require additional resources or training, but may not achieve the
same accuracy as learned refinement.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sleap.nn.config.model.ClassMapsHeadConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sleap.nn.config.model.</span></span><span class="sig-name descname"><span class="pre">ClassMapsHeadConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">classes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/talmolab/sleap/blob/v1.3.3/sleap/nn/config/model.py#L290-L316"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.config.model.ClassMapsHeadConfig" title="Permalink to this definition">#</a></dt>
<dd><p>Configurations for class map heads.</p>
<p>These heads are used in bottom-up multi-instance models that classify detected
points using a fixed set of learned classes (e.g., animal identities).</p>
<p>Class maps are an image-space representation of the probability of that each class
occupies a given pixel. This is similar to semantic segmentation, however only the
pixels in the neighborhood of the landmarks have a class assignment.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.ClassMapsHeadConfig.classes">
<span class="sig-name descname"><span class="pre">classes</span></span><a class="headerlink" href="#sleap.nn.config.model.ClassMapsHeadConfig.classes" title="Permalink to this definition">#</a></dt>
<dd><p>List of string names of the classes that this head will predict.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Optional[List[str]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.ClassMapsHeadConfig.sigma">
<span class="sig-name descname"><span class="pre">sigma</span></span><a class="headerlink" href="#sleap.nn.config.model.ClassMapsHeadConfig.sigma" title="Permalink to this definition">#</a></dt>
<dd><p>Spread of the Gaussian distribution that determines the neighborhood
that the class maps will be nonzero around each landmark.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.ClassMapsHeadConfig.output_stride">
<span class="sig-name descname"><span class="pre">output_stride</span></span><a class="headerlink" href="#sleap.nn.config.model.ClassMapsHeadConfig.output_stride" title="Permalink to this definition">#</a></dt>
<dd><p>The stride of the output class maps relative to the input image.
This is the reciprocal of the resolution, e.g., an output stride of 2
results in maps that are 0.5x the size of the input. This should be the same
size as the confidence maps they are associated with.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.ClassMapsHeadConfig.loss_weight">
<span class="sig-name descname"><span class="pre">loss_weight</span></span><a class="headerlink" href="#sleap.nn.config.model.ClassMapsHeadConfig.loss_weight" title="Permalink to this definition">#</a></dt>
<dd><p>Scalar float used to weigh the loss term for this head during
training. Increase this to encourage the optimization to focus on improving
this specific output in multi-head models.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sleap.nn.config.model.ClassVectorsHeadConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sleap.nn.config.model.</span></span><span class="sig-name descname"><span class="pre">ClassVectorsHeadConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">classes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_fc_layers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_fc_units</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_pool</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/talmolab/sleap/blob/v1.3.3/sleap/nn/config/model.py#L346-L377"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.config.model.ClassVectorsHeadConfig" title="Permalink to this definition">#</a></dt>
<dd><p>Configurations for class vectors heads.</p>
<p>These heads are used in top-down multi-instance models that classify detected
points using a fixed set of learned classes (e.g., animal identities).</p>
<p>Class vectors represent the probability that the image is associated with each of
the specified classes. This is similar to a standard classification task.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.ClassVectorsHeadConfig.classes">
<span class="sig-name descname"><span class="pre">classes</span></span><a class="headerlink" href="#sleap.nn.config.model.ClassVectorsHeadConfig.classes" title="Permalink to this definition">#</a></dt>
<dd><p>List of string names of the classes that this head will predict.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Optional[List[str]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.ClassVectorsHeadConfig.num_fc_layers">
<span class="sig-name descname"><span class="pre">num_fc_layers</span></span><a class="headerlink" href="#sleap.nn.config.model.ClassVectorsHeadConfig.num_fc_layers" title="Permalink to this definition">#</a></dt>
<dd><p>Number of fully-connected layers before the classification output
layer. These can help in transforming general image features into
classification-specific features.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.ClassVectorsHeadConfig.num_fc_units">
<span class="sig-name descname"><span class="pre">num_fc_units</span></span><a class="headerlink" href="#sleap.nn.config.model.ClassVectorsHeadConfig.num_fc_units" title="Permalink to this definition">#</a></dt>
<dd><p>Number of units (dimensions) in the fully-connected layers before
classification. Increasing this can improve the representational capacity in
the pre-classification layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.ClassVectorsHeadConfig.output_stride">
<span class="sig-name descname"><span class="pre">output_stride</span></span><a class="headerlink" href="#sleap.nn.config.model.ClassVectorsHeadConfig.output_stride" title="Permalink to this definition">#</a></dt>
<dd><p>The stride of the output class maps relative to the input image.
This is the reciprocal of the resolution, e.g., an output stride of 2
results in maps that are 0.5x the size of the input. This should be the same
size as the confidence maps they are associated with.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.ClassVectorsHeadConfig.loss_weight">
<span class="sig-name descname"><span class="pre">loss_weight</span></span><a class="headerlink" href="#sleap.nn.config.model.ClassVectorsHeadConfig.loss_weight" title="Permalink to this definition">#</a></dt>
<dd><p>Scalar float used to weigh the loss term for this head during
training. Increase this to encourage the optimization to focus on improving
this specific output in multi-head models.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sleap.nn.config.model.HeadsConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sleap.nn.config.model.</span></span><span class="sig-name descname"><span class="pre">HeadsConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/talmolab/sleap/blob/v1.3.3/sleap/nn/config/model.py#L410-L429"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.config.model.HeadsConfig" title="Permalink to this definition">#</a></dt>
<dd><p>Configurations related to the model output head type.</p>
<p>Only one attribute of this class can be set, which defines the model output type.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.HeadsConfig.single_instance">
<span class="sig-name descname"><span class="pre">single_instance</span></span><a class="headerlink" href="#sleap.nn.config.model.HeadsConfig.single_instance" title="Permalink to this definition">#</a></dt>
<dd><p>An instance of <a class="reference internal" href="#sleap.nn.config.model.SingleInstanceConfmapsHeadConfig" title="sleap.nn.config.model.SingleInstanceConfmapsHeadConfig"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SingleInstanceConfmapsHeadConfig</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Optional[<a class="reference internal" href="#sleap.nn.config.model.SingleInstanceConfmapsHeadConfig" title="sleap.nn.config.model.SingleInstanceConfmapsHeadConfig">sleap.nn.config.model.SingleInstanceConfmapsHeadConfig</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.HeadsConfig.centroid">
<span class="sig-name descname"><span class="pre">centroid</span></span><a class="headerlink" href="#sleap.nn.config.model.HeadsConfig.centroid" title="Permalink to this definition">#</a></dt>
<dd><p>An instance of <a class="reference internal" href="#sleap.nn.config.model.CentroidsHeadConfig" title="sleap.nn.config.model.CentroidsHeadConfig"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CentroidsHeadConfig</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Optional[<a class="reference internal" href="#sleap.nn.config.model.CentroidsHeadConfig" title="sleap.nn.config.model.CentroidsHeadConfig">sleap.nn.config.model.CentroidsHeadConfig</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.HeadsConfig.centered_instance">
<span class="sig-name descname"><span class="pre">centered_instance</span></span><a class="headerlink" href="#sleap.nn.config.model.HeadsConfig.centered_instance" title="Permalink to this definition">#</a></dt>
<dd><p>An instance of <a class="reference internal" href="#sleap.nn.config.model.CenteredInstanceConfmapsHeadConfig" title="sleap.nn.config.model.CenteredInstanceConfmapsHeadConfig"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CenteredInstanceConfmapsHeadConfig</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Optional[<a class="reference internal" href="#sleap.nn.config.model.CenteredInstanceConfmapsHeadConfig" title="sleap.nn.config.model.CenteredInstanceConfmapsHeadConfig">sleap.nn.config.model.CenteredInstanceConfmapsHeadConfig</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.HeadsConfig.multi_instance">
<span class="sig-name descname"><span class="pre">multi_instance</span></span><a class="headerlink" href="#sleap.nn.config.model.HeadsConfig.multi_instance" title="Permalink to this definition">#</a></dt>
<dd><p>An instance of <a class="reference internal" href="#sleap.nn.config.model.MultiInstanceConfig" title="sleap.nn.config.model.MultiInstanceConfig"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MultiInstanceConfig</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Optional[<a class="reference internal" href="#sleap.nn.config.model.MultiInstanceConfig" title="sleap.nn.config.model.MultiInstanceConfig">sleap.nn.config.model.MultiInstanceConfig</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.HeadsConfig.multi_class_bottomup">
<span class="sig-name descname"><span class="pre">multi_class_bottomup</span></span><a class="headerlink" href="#sleap.nn.config.model.HeadsConfig.multi_class_bottomup" title="Permalink to this definition">#</a></dt>
<dd><p>An instance of <a class="reference internal" href="#sleap.nn.config.model.MultiClassBottomUpConfig" title="sleap.nn.config.model.MultiClassBottomUpConfig"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MultiClassBottomUpConfig</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Optional[<a class="reference internal" href="#sleap.nn.config.model.MultiClassBottomUpConfig" title="sleap.nn.config.model.MultiClassBottomUpConfig">sleap.nn.config.model.MultiClassBottomUpConfig</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.HeadsConfig.multi_class_topdown">
<span class="sig-name descname"><span class="pre">multi_class_topdown</span></span><a class="headerlink" href="#sleap.nn.config.model.HeadsConfig.multi_class_topdown" title="Permalink to this definition">#</a></dt>
<dd><p>An instance of <a class="reference internal" href="#sleap.nn.config.model.MultiClassTopDownConfig" title="sleap.nn.config.model.MultiClassTopDownConfig"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MultiClassTopDownConfig</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Optional[<a class="reference internal" href="#sleap.nn.config.model.MultiClassTopDownConfig" title="sleap.nn.config.model.MultiClassTopDownConfig">sleap.nn.config.model.MultiClassTopDownConfig</a>]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sleap.nn.config.model.HourglassConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sleap.nn.config.model.</span></span><span class="sig-name descname"><span class="pre">HourglassConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stem_stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stem_filters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_increase</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stacks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/talmolab/sleap/blob/v1.3.3/sleap/nn/config/model.py#L489-L510"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.config.model.HourglassConfig" title="Permalink to this definition">#</a></dt>
<dd><p>Hourglass backbone configuration.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.HourglassConfig.stem_stride">
<span class="sig-name descname"><span class="pre">stem_stride</span></span><a class="headerlink" href="#sleap.nn.config.model.HourglassConfig.stem_stride" title="Permalink to this definition">#</a></dt>
<dd><p>Controls how many stem blocks to use for initial downsampling.
These are useful for learned downsampling that is able to retain spatial
information while reducing large input image sizes.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.HourglassConfig.max_stride">
<span class="sig-name descname"><span class="pre">max_stride</span></span><a class="headerlink" href="#sleap.nn.config.model.HourglassConfig.max_stride" title="Permalink to this definition">#</a></dt>
<dd><p>Determines the number of downsampling blocks in the network,
increasing receptive field size at the cost of network size.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.HourglassConfig.output_stride">
<span class="sig-name descname"><span class="pre">output_stride</span></span><a class="headerlink" href="#sleap.nn.config.model.HourglassConfig.output_stride" title="Permalink to this definition">#</a></dt>
<dd><p>Determines the number of upsampling blocks in the network.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.HourglassConfig.filters">
<span class="sig-name descname"><span class="pre">filters</span></span><a class="headerlink" href="#sleap.nn.config.model.HourglassConfig.filters" title="Permalink to this definition">#</a></dt>
<dd><p>Base number of filters in the network.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.HourglassConfig.filters_increase">
<span class="sig-name descname"><span class="pre">filters_increase</span></span><a class="headerlink" href="#sleap.nn.config.model.HourglassConfig.filters_increase" title="Permalink to this definition">#</a></dt>
<dd><p>Constant to increase the number of filters by at each block.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.HourglassConfig.stacks">
<span class="sig-name descname"><span class="pre">stacks</span></span><a class="headerlink" href="#sleap.nn.config.model.HourglassConfig.stacks" title="Permalink to this definition">#</a></dt>
<dd><p>Number of repeated stacks of the network (excluding the stem).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sleap.nn.config.model.LEAPConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sleap.nn.config.model.</span></span><span class="sig-name descname"><span class="pre">LEAPConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filters_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">up_interpolate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stacks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/talmolab/sleap/blob/v1.3.3/sleap/nn/config/model.py#L433-L453"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.config.model.LEAPConfig" title="Permalink to this definition">#</a></dt>
<dd><p>LEAP backbone configuration.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.LEAPConfig.max_stride">
<span class="sig-name descname"><span class="pre">max_stride</span></span><a class="headerlink" href="#sleap.nn.config.model.LEAPConfig.max_stride" title="Permalink to this definition">#</a></dt>
<dd><p>Determines the number of downsampling blocks in the network,
increasing receptive field size at the cost of network size.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.LEAPConfig.output_stride">
<span class="sig-name descname"><span class="pre">output_stride</span></span><a class="headerlink" href="#sleap.nn.config.model.LEAPConfig.output_stride" title="Permalink to this definition">#</a></dt>
<dd><p>Determines the number of upsampling blocks in the network.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.LEAPConfig.filters">
<span class="sig-name descname"><span class="pre">filters</span></span><a class="headerlink" href="#sleap.nn.config.model.LEAPConfig.filters" title="Permalink to this definition">#</a></dt>
<dd><p>Base number of filters in the network.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.LEAPConfig.filters_rate">
<span class="sig-name descname"><span class="pre">filters_rate</span></span><a class="headerlink" href="#sleap.nn.config.model.LEAPConfig.filters_rate" title="Permalink to this definition">#</a></dt>
<dd><p>Factor to scale the number of filters by at each block.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.LEAPConfig.up_interpolate">
<span class="sig-name descname"><span class="pre">up_interpolate</span></span><a class="headerlink" href="#sleap.nn.config.model.LEAPConfig.up_interpolate" title="Permalink to this definition">#</a></dt>
<dd><p>If True, use bilinear upsampling instead of transposed
convolutions for upsampling. This can save computations but may lower
overall accuracy.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.LEAPConfig.stacks">
<span class="sig-name descname"><span class="pre">stacks</span></span><a class="headerlink" href="#sleap.nn.config.model.LEAPConfig.stacks" title="Permalink to this definition">#</a></dt>
<dd><p>Number of repeated stacks of the network (excluding the stem).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sleap.nn.config.model.ModelConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sleap.nn.config.model.</span></span><span class="sig-name descname"><span class="pre">ModelConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">backbone</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#sleap.nn.config.model.BackboneConfig" title="sleap.nn.config.model.BackboneConfig"><span class="pre">sleap.nn.config.model.BackboneConfig</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">NOTHING</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">heads</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#sleap.nn.config.model.HeadsConfig" title="sleap.nn.config.model.HeadsConfig"><span class="pre">sleap.nn.config.model.HeadsConfig</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">NOTHING</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_checkpoint</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/talmolab/sleap/blob/v1.3.3/sleap/nn/config/model.py#L650-L661"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.config.model.ModelConfig" title="Permalink to this definition">#</a></dt>
<dd><p>Configurations related to model architecture.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.ModelConfig.backbone">
<span class="sig-name descname"><span class="pre">backbone</span></span><a class="headerlink" href="#sleap.nn.config.model.ModelConfig.backbone" title="Permalink to this definition">#</a></dt>
<dd><p>Configurations related to the main network architecture.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#sleap.nn.config.model.BackboneConfig" title="sleap.nn.config.model.BackboneConfig">sleap.nn.config.model.BackboneConfig</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.ModelConfig.heads">
<span class="sig-name descname"><span class="pre">heads</span></span><a class="headerlink" href="#sleap.nn.config.model.ModelConfig.heads" title="Permalink to this definition">#</a></dt>
<dd><p>Configurations related to the output heads.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#sleap.nn.config.model.HeadsConfig" title="sleap.nn.config.model.HeadsConfig">sleap.nn.config.model.HeadsConfig</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.ModelConfig.base_checkpoint">
<span class="sig-name descname"><span class="pre">base_checkpoint</span></span><a class="headerlink" href="#sleap.nn.config.model.ModelConfig.base_checkpoint" title="Permalink to this definition">#</a></dt>
<dd><p>Path to model folder for loading a checkpoint. Should contain the .h5 file</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Optional[str]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sleap.nn.config.model.MultiClassBottomUpConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sleap.nn.config.model.</span></span><span class="sig-name descname"><span class="pre">MultiClassBottomUpConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">confmaps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#sleap.nn.config.model.MultiInstanceConfmapsHeadConfig" title="sleap.nn.config.model.MultiInstanceConfmapsHeadConfig"><span class="pre">sleap.nn.config.model.MultiInstanceConfmapsHeadConfig</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">NOTHING</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_maps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#sleap.nn.config.model.ClassMapsHeadConfig" title="sleap.nn.config.model.ClassMapsHeadConfig"><span class="pre">sleap.nn.config.model.ClassMapsHeadConfig</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">NOTHING</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/talmolab/sleap/blob/v1.3.3/sleap/nn/config/model.py#L320-L342"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.config.model.MultiClassBottomUpConfig" title="Permalink to this definition">#</a></dt>
<dd><p>Configuration for multi-instance confidence map and class map models.</p>
<p>This configuration specifies a multi-head model that outputs both multi-instance
confidence maps and class maps, which together enable multi-instance pose tracking
in a bottom-up fashion, i.e., no instance cropping, centroids or PAFs are required.
The limitation with this approach is that the classes, e.g., animal identities, must
be labeled in the training data and cannot be generalized beyond those classes. This
is still useful for applications in which the animals are uniquely identifiable and
tracking their identities at inference time is critical, e.g., for closed loop
experiments.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.MultiClassBottomUpConfig.confmaps">
<span class="sig-name descname"><span class="pre">confmaps</span></span><a class="headerlink" href="#sleap.nn.config.model.MultiClassBottomUpConfig.confmaps" title="Permalink to this definition">#</a></dt>
<dd><p>Part confidence map configuration (see the description in
<a class="reference internal" href="#sleap.nn.config.model.MultiInstanceConfmapsHeadConfig" title="sleap.nn.config.model.MultiInstanceConfmapsHeadConfig"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MultiInstanceConfmapsHeadConfig</span></code></a>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#sleap.nn.config.model.MultiInstanceConfmapsHeadConfig" title="sleap.nn.config.model.MultiInstanceConfmapsHeadConfig">sleap.nn.config.model.MultiInstanceConfmapsHeadConfig</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.MultiClassBottomUpConfig.class_maps">
<span class="sig-name descname"><span class="pre">class_maps</span></span><a class="headerlink" href="#sleap.nn.config.model.MultiClassBottomUpConfig.class_maps" title="Permalink to this definition">#</a></dt>
<dd><p>Class map configuration (see the description in
<a class="reference internal" href="#sleap.nn.config.model.ClassMapsHeadConfig" title="sleap.nn.config.model.ClassMapsHeadConfig"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ClassMapsHeadConfig</span></code></a>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#sleap.nn.config.model.ClassMapsHeadConfig" title="sleap.nn.config.model.ClassMapsHeadConfig">sleap.nn.config.model.ClassMapsHeadConfig</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sleap.nn.config.model.MultiClassTopDownConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sleap.nn.config.model.</span></span><span class="sig-name descname"><span class="pre">MultiClassTopDownConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">confmaps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#sleap.nn.config.model.CenteredInstanceConfmapsHeadConfig" title="sleap.nn.config.model.CenteredInstanceConfmapsHeadConfig"><span class="pre">sleap.nn.config.model.CenteredInstanceConfmapsHeadConfig</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">NOTHING</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_vectors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#sleap.nn.config.model.ClassVectorsHeadConfig" title="sleap.nn.config.model.ClassVectorsHeadConfig"><span class="pre">sleap.nn.config.model.ClassVectorsHeadConfig</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">NOTHING</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/talmolab/sleap/blob/v1.3.3/sleap/nn/config/model.py#L381-L405"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.config.model.MultiClassTopDownConfig" title="Permalink to this definition">#</a></dt>
<dd><p>Configuration for centered-instance confidence map and class map models.</p>
<p>This configuration specifies a multi-head model that outputs both centered-instance
confidence maps and class vectors, which together enable multi-instance pose
tracking in a top-down fashion, i.e., instance-centered crops followed by pose
estimation and classification.</p>
<p>The limitation with this approach is that the classes, e.g., animal identities, must
be labeled in the training data and cannot be generalized beyond those classes. This
is still useful for applications in which the animals are uniquely identifiable and
tracking their identities at inference time is critical, e.g., for closed loop
experiments.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.MultiClassTopDownConfig.confmaps">
<span class="sig-name descname"><span class="pre">confmaps</span></span><a class="headerlink" href="#sleap.nn.config.model.MultiClassTopDownConfig.confmaps" title="Permalink to this definition">#</a></dt>
<dd><p>Part confidence map configuration (see the description in
<a class="reference internal" href="#sleap.nn.config.model.CenteredInstanceConfmapsHeadConfig" title="sleap.nn.config.model.CenteredInstanceConfmapsHeadConfig"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CenteredInstanceConfmapsHeadConfig</span></code></a>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#sleap.nn.config.model.CenteredInstanceConfmapsHeadConfig" title="sleap.nn.config.model.CenteredInstanceConfmapsHeadConfig">sleap.nn.config.model.CenteredInstanceConfmapsHeadConfig</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.MultiClassTopDownConfig.class_vectors">
<span class="sig-name descname"><span class="pre">class_vectors</span></span><a class="headerlink" href="#sleap.nn.config.model.MultiClassTopDownConfig.class_vectors" title="Permalink to this definition">#</a></dt>
<dd><p>Class map configuration (see the description in
<a class="reference internal" href="#sleap.nn.config.model.ClassVectorsHeadConfig" title="sleap.nn.config.model.ClassVectorsHeadConfig"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ClassVectorsHeadConfig</span></code></a>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#sleap.nn.config.model.ClassVectorsHeadConfig" title="sleap.nn.config.model.ClassVectorsHeadConfig">sleap.nn.config.model.ClassVectorsHeadConfig</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sleap.nn.config.model.MultiInstanceConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sleap.nn.config.model.</span></span><span class="sig-name descname"><span class="pre">MultiInstanceConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">confmaps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#sleap.nn.config.model.MultiInstanceConfmapsHeadConfig" title="sleap.nn.config.model.MultiInstanceConfmapsHeadConfig"><span class="pre">sleap.nn.config.model.MultiInstanceConfmapsHeadConfig</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">NOTHING</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pafs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#sleap.nn.config.model.PartAffinityFieldsHeadConfig" title="sleap.nn.config.model.PartAffinityFieldsHeadConfig"><span class="pre">sleap.nn.config.model.PartAffinityFieldsHeadConfig</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">NOTHING</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/talmolab/sleap/blob/v1.3.3/sleap/nn/config/model.py#L268-L286"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.config.model.MultiInstanceConfig" title="Permalink to this definition">#</a></dt>
<dd><p>Configuration for combined multi-instance confidence map and PAF model heads.</p>
<p>This configuration specifies a multi-head model that outputs both multi-instance
confidence maps and part affinity fields, which together enable multi-instance pose
estimation in a bottom-up fashion, i.e., no instance cropping or centroids are
required.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.MultiInstanceConfig.confmaps">
<span class="sig-name descname"><span class="pre">confmaps</span></span><a class="headerlink" href="#sleap.nn.config.model.MultiInstanceConfig.confmaps" title="Permalink to this definition">#</a></dt>
<dd><p>Part confidence map configuration (see the description in
<a class="reference internal" href="#sleap.nn.config.model.MultiInstanceConfmapsHeadConfig" title="sleap.nn.config.model.MultiInstanceConfmapsHeadConfig"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MultiInstanceConfmapsHeadConfig</span></code></a>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#sleap.nn.config.model.MultiInstanceConfmapsHeadConfig" title="sleap.nn.config.model.MultiInstanceConfmapsHeadConfig">sleap.nn.config.model.MultiInstanceConfmapsHeadConfig</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.MultiInstanceConfig.pafs">
<span class="sig-name descname"><span class="pre">pafs</span></span><a class="headerlink" href="#sleap.nn.config.model.MultiInstanceConfig.pafs" title="Permalink to this definition">#</a></dt>
<dd><p>Part affinity fields configuration (see the description in
<a class="reference internal" href="#sleap.nn.config.model.PartAffinityFieldsHeadConfig" title="sleap.nn.config.model.PartAffinityFieldsHeadConfig"><code class="xref py py-obj docutils literal notranslate"><span class="pre">PartAffinityFieldsHeadConfig</span></code></a>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#sleap.nn.config.model.PartAffinityFieldsHeadConfig" title="sleap.nn.config.model.PartAffinityFieldsHeadConfig">sleap.nn.config.model.PartAffinityFieldsHeadConfig</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sleap.nn.config.model.MultiInstanceConfmapsHeadConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sleap.nn.config.model.</span></span><span class="sig-name descname"><span class="pre">MultiInstanceConfmapsHeadConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">part_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset_refinement</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/talmolab/sleap/blob/v1.3.3/sleap/nn/config/model.py#L161-L213"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.config.model.MultiInstanceConfmapsHeadConfig" title="Permalink to this definition">#</a></dt>
<dd><p>Configurations for multi-instance confidence map heads.</p>
<p>These heads are used in bottom-up multi-instance models that do not make any
assumption about the connectivity of the body parts. These heads will generate
multiple local peaks for each body part type and must be detected using local peak
finding.</p>
<p>Although this head alone is sufficient to detect multiple copies of each body part
type, it provides no information as to which sets of points should be grouped
together to the same instance. If this is required, a head that provides
connectivity or grouping information is required, e.g., part affinity fields.</p>
<p>Use this head when multiple instances of each body part are present and do not need
to be grouped or will be grouped using additional information.</p>
<p>This head type has the advantage that it only needs to evaluate each frame once to
find all peaks, in contrast to topdown models that must be evaluated for each crop.
This constant scaling with the number of instances can be especially beneficial when
there are many animals present in the frame.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.MultiInstanceConfmapsHeadConfig.part_names">
<span class="sig-name descname"><span class="pre">part_names</span></span><a class="headerlink" href="#sleap.nn.config.model.MultiInstanceConfmapsHeadConfig.part_names" title="Permalink to this definition">#</a></dt>
<dd><p>Text name of the body parts (nodes) that the head will be configured
to produce. The number of parts determines the number of channels in the
output. If not specified, all body parts in the skeleton will be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Optional[List[str]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.MultiInstanceConfmapsHeadConfig.sigma">
<span class="sig-name descname"><span class="pre">sigma</span></span><a class="headerlink" href="#sleap.nn.config.model.MultiInstanceConfmapsHeadConfig.sigma" title="Permalink to this definition">#</a></dt>
<dd><p>Spread of the Gaussian distribution of the confidence maps as a scalar
float. Smaller values are more precise but may be difficult to learn as they
have a lower density within the image space. Larger values are easier to
learn but are less precise with respect to the peak coordinate. This spread
is in units of pixels of the model input image, i.e., the image resolution
after any input scaling is applied.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.MultiInstanceConfmapsHeadConfig.output_stride">
<span class="sig-name descname"><span class="pre">output_stride</span></span><a class="headerlink" href="#sleap.nn.config.model.MultiInstanceConfmapsHeadConfig.output_stride" title="Permalink to this definition">#</a></dt>
<dd><p>The stride of the output confidence maps relative to the input
image. This is the reciprocal of the resolution, e.g., an output stride of 2
results in confidence maps that are 0.5x the size of the input. Increasing
this value can considerably speed up model performance and decrease memory
requirements, at the cost of decreased spatial resolution.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.MultiInstanceConfmapsHeadConfig.loss_weight">
<span class="sig-name descname"><span class="pre">loss_weight</span></span><a class="headerlink" href="#sleap.nn.config.model.MultiInstanceConfmapsHeadConfig.loss_weight" title="Permalink to this definition">#</a></dt>
<dd><p>Scalar float used to weigh the loss term for this head during
training. Increase this to encourage the optimization to focus on improving
this specific output in multi-head models.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.MultiInstanceConfmapsHeadConfig.offset_refinement">
<span class="sig-name descname"><span class="pre">offset_refinement</span></span><a class="headerlink" href="#sleap.nn.config.model.MultiInstanceConfmapsHeadConfig.offset_refinement" title="Permalink to this definition">#</a></dt>
<dd><p>If <code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code>, model will also output an offset refinement map
used to achieve subpixel localization of peaks during inference. This can
improve the localization accuracy of the model at the cost of additional
memory and training and inference time. If <code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code> (the default), subpixel
localization can be achieved post-hoc with deterministic refinement, which
does not require additional resources or training, but may not achieve the
same accuracy as learned refinement.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sleap.nn.config.model.PartAffinityFieldsHeadConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sleap.nn.config.model.</span></span><span class="sig-name descname"><span class="pre">PartAffinityFieldsHeadConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">edges</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">15.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/talmolab/sleap/blob/v1.3.3/sleap/nn/config/model.py#L217-L264"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.config.model.PartAffinityFieldsHeadConfig" title="Permalink to this definition">#</a></dt>
<dd><p>Configurations for multi-instance part affinity field heads.</p>
<p>These heads are used in bottom-up multi-instance models that require information
about body part connectivity in order to group multiple detections of each body part
type into distinct instances.</p>
<p>Part affinity fields are an image-space representation of the directed graph that
defines the skeleton. Pixels that are close to the line (directed edge) formed
between pairs of nodes of the same instance will contain unit vectors pointing along
the direction of the the connection. The similarity between this line and the
average of the unit vectors at the pixels underneath the line can be used as a
matching score to associate candidate pairs of body part detections.</p>
<p>Use this head when multiple instances of each body part are present and need to be
grouped to coherent instances.</p>
<p>This head type has the advantage that it only needs to evaluate each frame once to
find all peaks, in contrast to topdown models that must be evaluated for each crop.
This constant scaling with the number of instances can be especially beneficial when
there are many animals present in the frame.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.PartAffinityFieldsHeadConfig.edges">
<span class="sig-name descname"><span class="pre">edges</span></span><a class="headerlink" href="#sleap.nn.config.model.PartAffinityFieldsHeadConfig.edges" title="Permalink to this definition">#</a></dt>
<dd><p>List of 2-tuples of the form <code class="xref py py-obj docutils literal notranslate"><span class="pre">(source_node,</span> <span class="pre">destination_node)</span></code> that
define pairs of text names of the directed edges of the graph. If not set,
all edges in the skeleton will be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Optional[Sequence[Tuple[str, str]]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.PartAffinityFieldsHeadConfig.sigma">
<span class="sig-name descname"><span class="pre">sigma</span></span><a class="headerlink" href="#sleap.nn.config.model.PartAffinityFieldsHeadConfig.sigma" title="Permalink to this definition">#</a></dt>
<dd><p>Spread of the Gaussian distribution that weigh the part affinity fields
as a function of their distance from the edge they represent. Smaller values
are more precise but may be difficult to learn as they have a lower density
within the image space. Larger values are easier to learn but are less
precise with respect to the edge distance, so can be less useful in
disambiguating between edges that are nearby and parallel in direction. This
spread is in units of pixels of the model input image, i.e., the image
resolution after any input scaling is applied.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.PartAffinityFieldsHeadConfig.output_stride">
<span class="sig-name descname"><span class="pre">output_stride</span></span><a class="headerlink" href="#sleap.nn.config.model.PartAffinityFieldsHeadConfig.output_stride" title="Permalink to this definition">#</a></dt>
<dd><p>The stride of the output part affinity fields relative to the
input image. This is the reciprocal of the resolution, e.g., an output
stride of 2 results in PAFs that are 0.5x the size of the input. Increasing
this value can considerably speed up model performance and decrease memory
requirements, at the cost of decreased spatial resolution.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.PartAffinityFieldsHeadConfig.loss_weight">
<span class="sig-name descname"><span class="pre">loss_weight</span></span><a class="headerlink" href="#sleap.nn.config.model.PartAffinityFieldsHeadConfig.loss_weight" title="Permalink to this definition">#</a></dt>
<dd><p>Scalar float used to weigh the loss term for this head during
training. Increase this to encourage the optimization to focus on improving
this specific output in multi-head models.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sleap.nn.config.model.PretrainedEncoderConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sleap.nn.config.model.</span></span><span class="sig-name descname"><span class="pre">PretrainedEncoderConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">encoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'efficientnetb0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretrained</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decoder_filters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decoder_filters_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decoder_batchnorm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/talmolab/sleap/blob/v1.3.3/sleap/nn/config/model.py#L593-L625"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.config.model.PretrainedEncoderConfig" title="Permalink to this definition">#</a></dt>
<dd><p>Configuration for UNet backbone with pretrained encoder.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.PretrainedEncoderConfig.encoder">
<span class="sig-name descname"><span class="pre">encoder</span></span><a class="headerlink" href="#sleap.nn.config.model.PretrainedEncoderConfig.encoder" title="Permalink to this definition">#</a></dt>
<dd><p>Name of the network architecture to use as the encoder. Valid encoder
names are:
- <code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;vgg16&quot;,</span> <span class="pre">&quot;vgg19&quot;,</span></code>
- <code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;resnet18&quot;,</span> <span class="pre">&quot;resnet34&quot;,</span> <span class="pre">&quot;resnet50&quot;,</span> <span class="pre">&quot;resnet101&quot;,</span> <span class="pre">&quot;resnet152&quot;</span></code>
- <code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;resnext50&quot;,</span> <span class="pre">&quot;resnext101&quot;</span></code>
- <code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;inceptionv3&quot;,</span> <span class="pre">&quot;inceptionresnetv2&quot;</span></code>
- <code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;densenet121&quot;,</span> <span class="pre">&quot;densenet169&quot;,</span> <span class="pre">&quot;densenet201&quot;</span></code>
- <code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;seresnet18&quot;,</span> <span class="pre">&quot;seresnet34&quot;,</span> <span class="pre">&quot;seresnet50&quot;,</span> <span class="pre">&quot;seresnet101&quot;,</span> <span class="pre">&quot;seresnet152&quot;,</span></code></p>
<blockquote>
<div><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;seresnext50&quot;,</span> <span class="pre">&quot;seresnext101&quot;,</span> <span class="pre">&quot;senet154&quot;</span></code></p>
</div></blockquote>
<ul class="simple">
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;mobilenet&quot;,</span> <span class="pre">&quot;mobilenetv2&quot;</span></code></p></li>
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;efficientnetb0&quot;,</span> <span class="pre">&quot;efficientnetb1&quot;,</span> <span class="pre">&quot;efficientnetb2&quot;,</span> <span class="pre">&quot;efficientnetb3&quot;,</span></code>
<code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;efficientnetb4&quot;,</span> <span class="pre">&quot;efficientnetb5&quot;,</span> <span class="pre">&quot;efficientnetb6&quot;,</span> <span class="pre">&quot;efficientnetb7&quot;</span></code></p></li>
</ul>
<p>Defaults to <code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;efficientnetb0&quot;</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.PretrainedEncoderConfig.pretrained">
<span class="sig-name descname"><span class="pre">pretrained</span></span><a class="headerlink" href="#sleap.nn.config.model.PretrainedEncoderConfig.pretrained" title="Permalink to this definition">#</a></dt>
<dd><p>If <code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code>, use initialized with weights pretrained on ImageNet.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.PretrainedEncoderConfig.decoder_filters">
<span class="sig-name descname"><span class="pre">decoder_filters</span></span><a class="headerlink" href="#sleap.nn.config.model.PretrainedEncoderConfig.decoder_filters" title="Permalink to this definition">#</a></dt>
<dd><p>Base number of filters for the upsampling blocks in the
decoder.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.PretrainedEncoderConfig.decoder_filters_rate">
<span class="sig-name descname"><span class="pre">decoder_filters_rate</span></span><a class="headerlink" href="#sleap.nn.config.model.PretrainedEncoderConfig.decoder_filters_rate" title="Permalink to this definition">#</a></dt>
<dd><p>Factor to scale the number of filters by at each
consecutive upsampling block in the decoder.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.PretrainedEncoderConfig.output_stride">
<span class="sig-name descname"><span class="pre">output_stride</span></span><a class="headerlink" href="#sleap.nn.config.model.PretrainedEncoderConfig.output_stride" title="Permalink to this definition">#</a></dt>
<dd><p>Stride of the final output.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.PretrainedEncoderConfig.decoder_batchnorm">
<span class="sig-name descname"><span class="pre">decoder_batchnorm</span></span><a class="headerlink" href="#sleap.nn.config.model.PretrainedEncoderConfig.decoder_batchnorm" title="Permalink to this definition">#</a></dt>
<dd><p>If <code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code> (the default), use batch normalization in the
decoder layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sleap.nn.config.model.ResNetConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sleap.nn.config.model.</span></span><span class="sig-name descname"><span class="pre">ResNetConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'ResNet50'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'frozen'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upsampling</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#sleap.nn.config.model.UpsamplingConfig" title="sleap.nn.config.model.UpsamplingConfig"><span class="pre">sleap.nn.config.model.UpsamplingConfig</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/talmolab/sleap/blob/v1.3.3/sleap/nn/config/model.py#L563-L589"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.config.model.ResNetConfig" title="Permalink to this definition">#</a></dt>
<dd><p>ResNet backbone configuration.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.ResNetConfig.version">
<span class="sig-name descname"><span class="pre">version</span></span><a class="headerlink" href="#sleap.nn.config.model.ResNetConfig.version" title="Permalink to this definition">#</a></dt>
<dd><p>Name of the ResNetV1 variant. Can be one of: “ResNet50”, “ResNet101”,
or “ResNet152”.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.ResNetConfig.weights">
<span class="sig-name descname"><span class="pre">weights</span></span><a class="headerlink" href="#sleap.nn.config.model.ResNetConfig.weights" title="Permalink to this definition">#</a></dt>
<dd><p>Controls how the network weights are initialized. If “random”, the
network is not pretrained. If “frozen”, the network uses pretrained weights
and keeps them fixed. If “tunable”, the network uses pretrained weights and
allows them to be trainable.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.ResNetConfig.upsampling">
<span class="sig-name descname"><span class="pre">upsampling</span></span><a class="headerlink" href="#sleap.nn.config.model.ResNetConfig.upsampling" title="Permalink to this definition">#</a></dt>
<dd><p>A <a class="reference internal" href="#sleap.nn.config.model.UpsamplingConfig" title="sleap.nn.config.model.UpsamplingConfig"><code class="xref py py-obj docutils literal notranslate"><span class="pre">UpsamplingConfig</span></code></a> that defines an upsampling branch if not None.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Optional[<a class="reference internal" href="#sleap.nn.config.model.UpsamplingConfig" title="sleap.nn.config.model.UpsamplingConfig">sleap.nn.config.model.UpsamplingConfig</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.ResNetConfig.max_stride">
<span class="sig-name descname"><span class="pre">max_stride</span></span><a class="headerlink" href="#sleap.nn.config.model.ResNetConfig.max_stride" title="Permalink to this definition">#</a></dt>
<dd><p>Stride of the backbone feature activations. These should be &lt;= 32.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.ResNetConfig.output_stride">
<span class="sig-name descname"><span class="pre">output_stride</span></span><a class="headerlink" href="#sleap.nn.config.model.ResNetConfig.output_stride" title="Permalink to this definition">#</a></dt>
<dd><p>Stride of the final output. If the upsampling branch is not
defined, the output stride is controlled via dilated convolutions or reduced
pooling in the backbone.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sleap.nn.config.model.SingleInstanceConfmapsHeadConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sleap.nn.config.model.</span></span><span class="sig-name descname"><span class="pre">SingleInstanceConfmapsHeadConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">part_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset_refinement</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/talmolab/sleap/blob/v1.3.3/sleap/nn/config/model.py#L7-L47"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.config.model.SingleInstanceConfmapsHeadConfig" title="Permalink to this definition">#</a></dt>
<dd><p>Configurations for single instance confidence map heads.</p>
<p>These heads are used in single instance models that make the assumption that only
one of each body part is present in the image. These heads produce confidence maps
with a single peak for each part type which can be detected via global peak finding.</p>
<p>Do not use this head if there is more than one animal present in the image.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.SingleInstanceConfmapsHeadConfig.part_names">
<span class="sig-name descname"><span class="pre">part_names</span></span><a class="headerlink" href="#sleap.nn.config.model.SingleInstanceConfmapsHeadConfig.part_names" title="Permalink to this definition">#</a></dt>
<dd><p>Text name of the body parts (nodes) that the head will be configured
to produce. The number of parts determines the number of channels in the
output. If not specified, all body parts in the skeleton will be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Optional[List[str]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.SingleInstanceConfmapsHeadConfig.sigma">
<span class="sig-name descname"><span class="pre">sigma</span></span><a class="headerlink" href="#sleap.nn.config.model.SingleInstanceConfmapsHeadConfig.sigma" title="Permalink to this definition">#</a></dt>
<dd><p>Spread of the Gaussian distribution of the confidence maps as a scalar
float. Smaller values are more precise but may be difficult to learn as they
have a lower density within the image space. Larger values are easier to
learn but are less precise with respect to the peak coordinate. This spread
is in units of pixels of the model input image, i.e., the image resolution
after any input scaling is applied.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.SingleInstanceConfmapsHeadConfig.output_stride">
<span class="sig-name descname"><span class="pre">output_stride</span></span><a class="headerlink" href="#sleap.nn.config.model.SingleInstanceConfmapsHeadConfig.output_stride" title="Permalink to this definition">#</a></dt>
<dd><p>The stride of the output confidence maps relative to the input
image. This is the reciprocal of the resolution, e.g., an output stride of 2
results in confidence maps that are 0.5x the size of the input. Increasing
this value can considerably speed up model performance and decrease memory
requirements, at the cost of decreased spatial resolution.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.SingleInstanceConfmapsHeadConfig.loss_weight">
<span class="sig-name descname"><span class="pre">loss_weight</span></span><a class="headerlink" href="#sleap.nn.config.model.SingleInstanceConfmapsHeadConfig.loss_weight" title="Permalink to this definition">#</a></dt>
<dd><p>Scalar float used to weigh the loss term for this head during
training. Increase this to encourage the optimization to focus on improving
this specific output in multi-head models.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.SingleInstanceConfmapsHeadConfig.offset_refinement">
<span class="sig-name descname"><span class="pre">offset_refinement</span></span><a class="headerlink" href="#sleap.nn.config.model.SingleInstanceConfmapsHeadConfig.offset_refinement" title="Permalink to this definition">#</a></dt>
<dd><p>If <code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code>, model will also output an offset refinement map
used to achieve subpixel localization of peaks during inference. This can
improve the localization accuracy of the model at the cost of additional
memory and training and inference time. If <code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code> (the default), subpixel
localization can be achieved post-hoc with deterministic refinement, which
does not require additional resources or training, but may not achieve the
same accuracy as learned refinement.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sleap.nn.config.model.UNetConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sleap.nn.config.model.</span></span><span class="sig-name descname"><span class="pre">UNetConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stem_stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filters_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">middle_block</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">up_interpolate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stacks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/talmolab/sleap/blob/v1.3.3/sleap/nn/config/model.py#L457-L485"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.config.model.UNetConfig" title="Permalink to this definition">#</a></dt>
<dd><p>UNet backbone configuration.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.UNetConfig.stem_stride">
<span class="sig-name descname"><span class="pre">stem_stride</span></span><a class="headerlink" href="#sleap.nn.config.model.UNetConfig.stem_stride" title="Permalink to this definition">#</a></dt>
<dd><p>If not None, controls how many stem blocks to use for initial
downsampling. These are useful for learned downsampling that is able to
retain spatial information while reducing large input image sizes.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Optional[int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.UNetConfig.max_stride">
<span class="sig-name descname"><span class="pre">max_stride</span></span><a class="headerlink" href="#sleap.nn.config.model.UNetConfig.max_stride" title="Permalink to this definition">#</a></dt>
<dd><p>Determines the number of downsampling blocks in the network,
increasing receptive field size at the cost of network size.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.UNetConfig.output_stride">
<span class="sig-name descname"><span class="pre">output_stride</span></span><a class="headerlink" href="#sleap.nn.config.model.UNetConfig.output_stride" title="Permalink to this definition">#</a></dt>
<dd><p>Determines the number of upsampling blocks in the network.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.UNetConfig.filters">
<span class="sig-name descname"><span class="pre">filters</span></span><a class="headerlink" href="#sleap.nn.config.model.UNetConfig.filters" title="Permalink to this definition">#</a></dt>
<dd><p>Base number of filters in the network.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.UNetConfig.filters_rate">
<span class="sig-name descname"><span class="pre">filters_rate</span></span><a class="headerlink" href="#sleap.nn.config.model.UNetConfig.filters_rate" title="Permalink to this definition">#</a></dt>
<dd><p>Factor to scale the number of filters by at each block.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.UNetConfig.middle_block">
<span class="sig-name descname"><span class="pre">middle_block</span></span><a class="headerlink" href="#sleap.nn.config.model.UNetConfig.middle_block" title="Permalink to this definition">#</a></dt>
<dd><p>If True, add an intermediate block between the downsampling and
upsampling branch for additional processing for features at the largest
receptive field size. This will not introduce an extra pooling step.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.UNetConfig.up_interpolate">
<span class="sig-name descname"><span class="pre">up_interpolate</span></span><a class="headerlink" href="#sleap.nn.config.model.UNetConfig.up_interpolate" title="Permalink to this definition">#</a></dt>
<dd><p>If True, use bilinear upsampling instead of transposed
convolutions for upsampling. This can save computations but may lower
overall accuracy.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.UNetConfig.stacks">
<span class="sig-name descname"><span class="pre">stacks</span></span><a class="headerlink" href="#sleap.nn.config.model.UNetConfig.stacks" title="Permalink to this definition">#</a></dt>
<dd><p>Number of repeated stacks of the network (excluding the stem).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sleap.nn.config.model.UpsamplingConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sleap.nn.config.model.</span></span><span class="sig-name descname"><span class="pre">UpsamplingConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'interpolation'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_connections</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">block_stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filters_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine_convs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_norm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transposed_conv_kernel_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/talmolab/sleap/blob/v1.3.3/sleap/nn/config/model.py#L514-L559"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.config.model.UpsamplingConfig" title="Permalink to this definition">#</a></dt>
<dd><p>Upsampling stack configuration.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.UpsamplingConfig.method">
<span class="sig-name descname"><span class="pre">method</span></span><a class="headerlink" href="#sleap.nn.config.model.UpsamplingConfig.method" title="Permalink to this definition">#</a></dt>
<dd><p>If “transposed_conv”, use a strided transposed convolution to perform
learnable upsampling. If “interpolation”, bilinear upsampling will be used
instead.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.UpsamplingConfig.skip_connections">
<span class="sig-name descname"><span class="pre">skip_connections</span></span><a class="headerlink" href="#sleap.nn.config.model.UpsamplingConfig.skip_connections" title="Permalink to this definition">#</a></dt>
<dd><p>If “add”, incoming feature tensors form skip connection with
upsampled features via element-wise addition. Height/width are matched via
stride and a 1x1 linear conv is applied if the channel counts do no match
up. If “concatenate”, the skip connection is formed via channel-wise
concatenation. If None, skip connections will not be formed.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Optional[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.UpsamplingConfig.block_stride">
<span class="sig-name descname"><span class="pre">block_stride</span></span><a class="headerlink" href="#sleap.nn.config.model.UpsamplingConfig.block_stride" title="Permalink to this definition">#</a></dt>
<dd><p>The striding of the upsampling <em>layer</em> (not tensor). This is
typically set to 2, such that the tensor doubles in size with each
upsampling step, but can be set higher to upsample to the desired
<code class="xref py py-obj docutils literal notranslate"><span class="pre">output_stride</span></code> directly in fewer steps.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.UpsamplingConfig.filters">
<span class="sig-name descname"><span class="pre">filters</span></span><a class="headerlink" href="#sleap.nn.config.model.UpsamplingConfig.filters" title="Permalink to this definition">#</a></dt>
<dd><p>Integer that specifies the base number of filters in each convolution
layer. This will be scaled by the <a class="reference internal" href="#sleap.nn.config.model.UpsamplingConfig.filters_rate" title="sleap.nn.config.model.UpsamplingConfig.filters_rate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filters_rate</span></code></a> at every upsampling step.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.UpsamplingConfig.filters_rate">
<span class="sig-name descname"><span class="pre">filters_rate</span></span><a class="headerlink" href="#sleap.nn.config.model.UpsamplingConfig.filters_rate" title="Permalink to this definition">#</a></dt>
<dd><p>Factor to scale the number of filters in the convolution layers
after each upsampling step. If set to 1, the number of filters won’t change.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.UpsamplingConfig.refine_convs">
<span class="sig-name descname"><span class="pre">refine_convs</span></span><a class="headerlink" href="#sleap.nn.config.model.UpsamplingConfig.refine_convs" title="Permalink to this definition">#</a></dt>
<dd><p>If greater than 0, specifies the number of 3x3 convolutions that
will be applied after the upsampling step for refinement. These layers can
serve the purpose of “mixing” the skip connection fused features, or to
refine the current feature map after upsampling, which can help to prevent
aliasing and checkerboard effects. If 0, no additional convolutions will be
applied.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.UpsamplingConfig.conv_batchnorm">
<span class="sig-name descname"><span class="pre">conv_batchnorm</span></span><a class="headerlink" href="#sleap.nn.config.model.UpsamplingConfig.conv_batchnorm" title="Permalink to this definition">#</a></dt>
<dd><p>Specifies whether batch norm should be applied after each
convolution (and before the ReLU activation).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sleap.nn.config.model.UpsamplingConfig.transposed_conv_kernel_size">
<span class="sig-name descname"><span class="pre">transposed_conv_kernel_size</span></span><a class="headerlink" href="#sleap.nn.config.model.UpsamplingConfig.transposed_conv_kernel_size" title="Permalink to this definition">#</a></dt>
<dd><p>Size of the kernel for the transposed convolution.
No effect if bilinear upsampling is used.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By SLEAP Developers
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2019–2024, Talmo Lab.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>