

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>sleap.nn.evals &#8212; SLEAP (v1.4.1)</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/tabs.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'api/sleap.nn.evals';</script>
    <link rel="canonical" href="/develop/api/sleap.nn.evals.html" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials/tutorial.html">Tutorial</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/new-project.html">Creating a project</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/initial-labeling.html">Initial Labeling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/initial-training.html">Training and Inference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/assisted-labeling.html">Prediction-assisted labeling</a></li>

<li class="toctree-l2"><a class="reference internal" href="../tutorials/proofreading.html">Tracking instances across frames</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/analysis.html">Export Data For Analysis</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../guides/index.html">Guides</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../guides/gui.html">GUI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/cli.html">Command line interfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/troubleshooting-workflows.html">Troubleshooting workflows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/skeletons.html">Skeleton design</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/choosing-models.html">Configuring models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/merging.html">Importing predictions for labeling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/proofreading.html">Tracking and proofreading</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/colab.html">Run training and inference on Colab</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/custom-training.html">Creating a custom training profile</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/remote.html">Running SLEAP remotely</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/bonsai.html">Using Bonsai with SLEAP</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../notebooks/index.html">Notebooks</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/Training_and_inference_on_an_example_dataset.html">Training and inference on an example dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/Training_and_inference_using_Google_Drive.html">Training and inference on your own data using Google Drive</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/Model_evaluation.html">Model evaluation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/Analysis_examples.html">Analysis examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/Data_structures.html">Data structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/Post_inference_tracking.html">Post-inference tracking</a></li>



<li class="toctree-l2"><a class="reference internal" href="../notebooks/Interactive_and_resumable_training.html">Interactive and resumable training</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/Interactive_and_realtime_inference.html">Interactive and realtime inference</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api.html">Developer API</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../datasets.html">Datasets</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/talmolab/sleap">GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/talmolab/sleap/releases">Releases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../help.html">Help</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/talmolab/sleap" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/talmolab/sleap/issues/new?title=Issue%20on%20page%20%2Fapi/sleap.nn.evals.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>sleap.nn.evals</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sleap.nn.evals.compute_dist_metrics"><code class="docutils literal notranslate"><span class="pre">compute_dist_metrics()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sleap.nn.evals.compute_dists"><code class="docutils literal notranslate"><span class="pre">compute_dists()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sleap.nn.evals.compute_generalized_voc_metrics"><code class="docutils literal notranslate"><span class="pre">compute_generalized_voc_metrics()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sleap.nn.evals.compute_instance_area"><code class="docutils literal notranslate"><span class="pre">compute_instance_area()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sleap.nn.evals.compute_oks"><code class="docutils literal notranslate"><span class="pre">compute_oks()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sleap.nn.evals.compute_pck_metrics"><code class="docutils literal notranslate"><span class="pre">compute_pck_metrics()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sleap.nn.evals.compute_visibility_conf"><code class="docutils literal notranslate"><span class="pre">compute_visibility_conf()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sleap.nn.evals.evaluate"><code class="docutils literal notranslate"><span class="pre">evaluate()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sleap.nn.evals.evaluate_model"><code class="docutils literal notranslate"><span class="pre">evaluate_model()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sleap.nn.evals.find_frame_pairs"><code class="docutils literal notranslate"><span class="pre">find_frame_pairs()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sleap.nn.evals.load_metrics"><code class="docutils literal notranslate"><span class="pre">load_metrics()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sleap.nn.evals.match_frame_pairs"><code class="docutils literal notranslate"><span class="pre">match_frame_pairs()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sleap.nn.evals.match_instances"><code class="docutils literal notranslate"><span class="pre">match_instances()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sleap.nn.evals.replace_path"><code class="docutils literal notranslate"><span class="pre">replace_path()</span></code></a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="module-sleap.nn.evals">
<span id="sleap-nn-evals"></span><h1>sleap.nn.evals<a class="headerlink" href="#module-sleap.nn.evals" title="Permalink to this heading">#</a></h1>
<p>Evaluation utilities for measuring pose estimation accuracy.</p>
<p>To generate metrics, you’ll need two <code class="xref py py-obj docutils literal notranslate"><span class="pre">Labels</span></code> datasets, one with ground truth
data and one with predicted data. The video paths in the datasets must match.
Load both datasets and call <a class="reference internal" href="#sleap.nn.evals.evaluate" title="sleap.nn.evals.evaluate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate</span></code></a>, like so:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">labels_gt</span> <span class="o">=</span> <span class="n">Labels</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="s2">&quot;path/to/ground/truth.slp&quot;</span><span class="p">)</span>
<span class="o">&gt;</span> <span class="n">labels_pr</span> <span class="o">=</span> <span class="n">Labels</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="s2">&quot;path/to/predictions.slp&quot;</span><span class="p">)</span>
<span class="o">&gt;</span> <span class="n">metrics</span> <span class="o">=</span> <span class="n">evaluate</span><span class="p">(</span><span class="n">labels_gt</span><span class="p">,</span> <span class="n">labels_pr</span><span class="p">)</span>
</pre></div>
</div>
<p><a class="reference internal" href="#sleap.nn.evals.evaluate" title="sleap.nn.evals.evaluate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate</span></code></a> returns a dictionary, keys are strings which name the metric,
values are either floats or numpy arrays.</p>
<p>A good place to start if you want to understand how well your models are
performing is to look at:</p>
<blockquote>
<div><ul class="simple">
<li><p>oks_voc.mAP</p></li>
<li><p>vis.precision</p></li>
<li><p>vis.recall</p></li>
<li><p>dist.p95</p></li>
</ul>
</div></blockquote>
<dl class="py function">
<dt class="sig sig-object py" id="sleap.nn.evals.compute_dist_metrics">
<span class="sig-prename descclassname"><span class="pre">sleap.nn.evals.</span></span><span class="sig-name descname"><span class="pre">compute_dist_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dists_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="sleap.instance.html#sleap.instance.Instance" title="sleap.instance.Instance"><span class="pre">Instance</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/talmolab/sleap/blob/v1.4.1/sleap/nn/evals.py#L523-L553"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.evals.compute_dist_metrics" title="Permalink to this definition">#</a></dt>
<dd><p>Compute the Euclidean distance error at different percentiles.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dists</strong> – An array of pairwise distances of shape <code class="xref py py-obj docutils literal notranslate"><span class="pre">(n_positive_pairs,</span> <span class="pre">n_nodes)</span></code>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary of distance metrics.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sleap.nn.evals.compute_dists">
<span class="sig-prename descclassname"><span class="pre">sleap.nn.evals.</span></span><span class="sig-name descname"><span class="pre">compute_dists</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">positive_pairs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="sleap.instance.html#sleap.instance.Instance" title="sleap.instance.Instance"><span class="pre">Instance</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="sleap.instance.html#sleap.instance.PredictedInstance" title="sleap.instance.PredictedInstance"><span class="pre">PredictedInstance</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/talmolab/sleap/blob/v1.4.1/sleap/nn/evals.py#L485-L520"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.evals.compute_dists" title="Permalink to this definition">#</a></dt>
<dd><p>Compute Euclidean distances between matched pairs of instances.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>positive_pairs</strong> – A list of tuples of the form <code class="xref py py-obj docutils literal notranslate"><span class="pre">(instance_gt,</span> <span class="pre">instance_pr,</span> <span class="pre">_)</span></code>
containing the matched pair of instances.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dists: An array of pairwise distances of shape <code class="xref py py-obj docutils literal notranslate"><span class="pre">(n_positive_pairs,</span> <span class="pre">n_nodes)</span></code>
frame_idxs: A list of frame indices corresponding to the <code class="xref py py-obj docutils literal notranslate"><span class="pre">dists</span></code>
video_paths: A list of video paths corresponding to the <code class="xref py py-obj docutils literal notranslate"><span class="pre">dists</span></code></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>A dictionary with the following keys</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sleap.nn.evals.compute_generalized_voc_metrics">
<span class="sig-prename descclassname"><span class="pre">sleap.nn.evals.</span></span><span class="sig-name descname"><span class="pre">compute_generalized_voc_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">positive_pairs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="sleap.instance.html#sleap.instance.Instance" title="sleap.instance.Instance"><span class="pre">Instance</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="sleap.instance.html#sleap.instance.PredictedInstance" title="sleap.instance.PredictedInstance"><span class="pre">PredictedInstance</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">false_negatives</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="sleap.instance.html#sleap.instance.Instance" title="sleap.instance.Instance"><span class="pre">Instance</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">match_scores</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">match_score_thresholds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">array([0.5,</span> <span class="pre">0.55,</span> <span class="pre">0.6,</span> <span class="pre">0.65,</span> <span class="pre">0.7,</span> <span class="pre">0.75,</span> <span class="pre">0.8,</span> <span class="pre">0.85,</span> <span class="pre">0.9,</span> <span class="pre">0.95])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recall_thresholds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">array([0.0,</span> <span class="pre">0.01,</span> <span class="pre">0.02,</span> <span class="pre">0.03,</span> <span class="pre">0.04,</span> <span class="pre">0.05,</span> <span class="pre">0.06,</span> <span class="pre">0.07,</span> <span class="pre">0.08,</span> <span class="pre">0.09,</span> <span class="pre">0.1,</span> <span class="pre">0.11,</span> <span class="pre">0.12,</span> <span class="pre">0.13,</span> <span class="pre">0.14,</span> <span class="pre">0.15,</span> <span class="pre">0.16,</span> <span class="pre">0.17,</span> <span class="pre">0.18,</span> <span class="pre">0.19,</span> <span class="pre">0.2,</span> <span class="pre">0.21,</span> <span class="pre">0.22,</span> <span class="pre">0.23,</span> <span class="pre">0.24,</span> <span class="pre">0.25,</span> <span class="pre">0.26,</span> <span class="pre">0.27,</span> <span class="pre">0.28,</span> <span class="pre">0.29,</span> <span class="pre">0.3,</span> <span class="pre">0.31,</span> <span class="pre">0.32,</span> <span class="pre">0.33,</span> <span class="pre">0.34,</span> <span class="pre">0.35,</span> <span class="pre">0.36,</span> <span class="pre">0.37,</span> <span class="pre">0.38,</span> <span class="pre">0.39,</span> <span class="pre">0.4,</span> <span class="pre">0.41,</span> <span class="pre">0.42,</span> <span class="pre">0.43,</span> <span class="pre">0.44,</span> <span class="pre">0.45,</span> <span class="pre">0.46,</span> <span class="pre">0.47,</span> <span class="pre">0.48,</span> <span class="pre">0.49,</span> <span class="pre">0.5,</span> <span class="pre">0.51,</span> <span class="pre">0.52,</span> <span class="pre">0.53,</span> <span class="pre">0.54,</span> <span class="pre">0.55,</span> <span class="pre">0.56,</span> <span class="pre">0.57,</span> <span class="pre">0.58,</span> <span class="pre">0.59,</span> <span class="pre">0.6,</span> <span class="pre">0.61,</span> <span class="pre">0.62,</span> <span class="pre">0.63,</span> <span class="pre">0.64,</span> <span class="pre">0.65,</span> <span class="pre">0.66,</span> <span class="pre">0.67,</span> <span class="pre">0.68,</span> <span class="pre">0.69,</span> <span class="pre">0.7,</span> <span class="pre">0.71,</span> <span class="pre">0.72,</span> <span class="pre">0.73,</span> <span class="pre">0.74,</span> <span class="pre">0.75,</span> <span class="pre">0.76,</span> <span class="pre">0.77,</span> <span class="pre">0.78,</span> <span class="pre">0.79,</span> <span class="pre">0.8,</span> <span class="pre">0.81,</span> <span class="pre">0.82,</span> <span class="pre">0.83,</span> <span class="pre">0.84,</span> <span class="pre">0.85,</span> <span class="pre">0.86,</span> <span class="pre">0.87,</span> <span class="pre">0.88,</span> <span class="pre">0.89,</span> <span class="pre">0.9,</span> <span class="pre">0.91,</span> <span class="pre">0.92,</span> <span class="pre">0.93,</span> <span class="pre">0.94,</span> <span class="pre">0.95,</span> <span class="pre">0.96,</span> <span class="pre">0.97,</span> <span class="pre">0.98,</span> <span class="pre">0.99,</span> <span class="pre">1.0])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'gvoc'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/talmolab/sleap/blob/v1.4.1/sleap/nn/evals.py#L402-L482"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.evals.compute_generalized_voc_metrics" title="Permalink to this definition">#</a></dt>
<dd><p>Compute VOC metrics given matched pairs of instances.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>positive_pairs</strong> – A list of tuples of the form <code class="xref py py-obj docutils literal notranslate"><span class="pre">(instance_gt,</span> <span class="pre">instance_pr,</span> <span class="pre">_)</span></code>
containing the matched pair of instances.</p></li>
<li><p><strong>false_negatives</strong> – A list of unmatched instances.</p></li>
<li><p><strong>match_scores</strong> – The score obtained in the matching procedure for each matched pair
(e.g., OKS).</p></li>
<li><p><strong>match_score_thresholds</strong> – Score thresholds at which to consider matches as a true
positive match.</p></li>
<li><p><strong>recall_thresholds</strong> – Recall thresholds at which to evaluate Average Precision.</p></li>
<li><p><strong>name</strong> – Name to use to prefix returned metric keys.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary of VOC metrics.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sleap.nn.evals.compute_instance_area">
<span class="sig-prename descclassname"><span class="pre">sleap.nn.evals.</span></span><span class="sig-name descname"><span class="pre">compute_instance_area</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference external" href="https://github.com/talmolab/sleap/blob/v1.4.1/sleap/nn/evals.py#L116-L131"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.evals.compute_instance_area" title="Permalink to this definition">#</a></dt>
<dd><p>Compute the area of the bounding box of a set of keypoints.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>points</strong> – A numpy array of coordinates.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The area of the bounding box of the points.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sleap.nn.evals.compute_oks">
<span class="sig-prename descclassname"><span class="pre">sleap.nn.evals.</span></span><span class="sig-name descname"><span class="pre">compute_oks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points_gt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">points_pr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stddev</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.025</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cocoeval</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference external" href="https://github.com/talmolab/sleap/blob/v1.4.1/sleap/nn/evals.py#L134-L250"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.evals.compute_oks" title="Permalink to this definition">#</a></dt>
<dd><p>Compute the object keypoints similarity between sets of points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>points_gt</strong> – Ground truth instances of shape (n_gt, n_nodes, n_ed),
where n_nodes is the number of body parts/keypoint types, and n_ed
is the number of Euclidean dimensions (typically 2 or 3). Keypoints
that are missing/not visible should be represented as NaNs.</p></li>
<li><p><strong>points_pr</strong> – Predicted instance of shape (n_pr, n_nodes, n_ed).</p></li>
<li><p><strong>use_cocoeval</strong> – Indicates whether the OKS score is calculated like cocoeval
method or not. True indicating the score is calculated using the
cocoeval method (widely used and the code can be found here at
<a class="github reference external" href="https://github.com/cocodataset/cocoapi/blob/8c9bcc3cf640524c4c20a9c40e89cb6a2f2fa0e9/PythonAPI/pycocotools/cocoeval.py#L192C5-L233C20">cocodataset/cocoapi</a>)
and False indicating the score is calculated using the method exactly
as given in the paper referenced in the Notes below.</p></li>
<li><p><strong>scale</strong> – Size scaling factor to use when weighing the scores, typically
the area of the bounding box of the instance (in pixels). This
should be of the length n_gt. If a scalar is provided, the same
number is used for all ground truth instances. If set to None, the
bounding box area of the ground truth instances will be calculated.</p></li>
<li><p><strong>stddev</strong> – The standard deviation associated with the spread in the
localization accuracy of each node/keypoint type. This should be of
the length n_nodes. “Easier” keypoint types will have lower values
to reflect the smaller spread expected in localizing it.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The object keypoints similarity between every pair of ground truth and
predicted instance, a numpy array of of shape (n_gt, n_pr) in the range
of [0, 1.0], with 1.0 denoting a perfect match.</p>
</dd>
</dl>
<div class="admonition-notes admonition">
<p class="admonition-title">Notes</p>
<p>It’s important to set the stddev appropriately when accounting for the
difficulty of each keypoint type. For reference, the median value for
all keypoint types in COCO is 0.072. The “easiest” keypoint is the left
eye, with stddev of 0.025, since it is easy to precisely locate the
eyes when labeling. The “hardest” keypoint is the left hip, with stddev
of 0.107, since it’s hard to locate the left hip bone without external
anatomical features and since it is often occluded by clothing.</p>
<p>The implementation here is based off of the descriptions in:
Ronch &amp; Perona. “Benchmarking and Error Diagnosis in Multi-Instance Pose
Estimation.” ICCV (2017).</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sleap.nn.evals.compute_pck_metrics">
<span class="sig-prename descclassname"><span class="pre">sleap.nn.evals.</span></span><span class="sig-name descname"><span class="pre">compute_pck_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dists</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresholds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">array([1.0,</span> <span class="pre">2.0,</span> <span class="pre">3.0,</span> <span class="pre">4.0,</span> <span class="pre">5.0,</span> <span class="pre">6.0,</span> <span class="pre">7.0,</span> <span class="pre">8.0,</span> <span class="pre">9.0,</span> <span class="pre">10.0])</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/talmolab/sleap/blob/v1.4.1/sleap/nn/evals.py#L556-L579"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.evals.compute_pck_metrics" title="Permalink to this definition">#</a></dt>
<dd><p>Compute PCK across a range of thresholds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dists</strong> – An array of pairwise distances of shape <code class="xref py py-obj docutils literal notranslate"><span class="pre">(n_positive_pairs,</span> <span class="pre">n_nodes)</span></code>.</p></li>
<li><p><strong>thresholds</strong> – A list of distance thresholds in pixels.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary of PCK metrics evaluated at each threshold.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sleap.nn.evals.compute_visibility_conf">
<span class="sig-prename descclassname"><span class="pre">sleap.nn.evals.</span></span><span class="sig-name descname"><span class="pre">compute_visibility_conf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">positive_pairs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="sleap.instance.html#sleap.instance.Instance" title="sleap.instance.Instance"><span class="pre">Instance</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="sleap.instance.html#sleap.instance.Instance" title="sleap.instance.Instance"><span class="pre">Instance</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/talmolab/sleap/blob/v1.4.1/sleap/nn/evals.py#L582-L615"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.evals.compute_visibility_conf" title="Permalink to this definition">#</a></dt>
<dd><p>Compute node visibility metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>positive_pairs</strong> – A list of tuples of the form <code class="xref py py-obj docutils literal notranslate"><span class="pre">(instance_gt,</span> <span class="pre">instance_pr,</span> <span class="pre">_)</span></code>
containing the matched pair of instances.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary of visibility metrics, including the confusion matrix.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sleap.nn.evals.evaluate">
<span class="sig-prename descclassname"><span class="pre">sleap.nn.evals.</span></span><span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels_gt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="sleap.io.dataset.html#sleap.io.dataset.Labels" title="sleap.io.dataset.Labels"><span class="pre">Labels</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels_pr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="sleap.io.dataset.html#sleap.io.dataset.Labels" title="sleap.io.dataset.Labels"><span class="pre">Labels</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">oks_stddev</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.025</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">oks_scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">match_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_labels_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/talmolab/sleap/blob/v1.4.1/sleap/nn/evals.py#L618-L680"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.evals.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate all metrics from ground truth and predicted labels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>labels_gt</strong> – The <code class="xref py py-obj docutils literal notranslate"><span class="pre">Labels</span></code> dataset object with ground truth labels.</p></li>
<li><p><strong>labels_pr</strong> – The <code class="xref py py-obj docutils literal notranslate"><span class="pre">Labels</span></code> dataset object with predicted labels.</p></li>
<li><p><strong>oks_stddev</strong> – The standard deviation to use for calculating object
keypoint similarity; see <a class="reference internal" href="#sleap.nn.evals.compute_oks" title="sleap.nn.evals.compute_oks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_oks</span></code></a> function for details.</p></li>
<li><p><strong>oks_scale</strong> – The scale to use for calculating object
keypoint similarity; see <a class="reference internal" href="#sleap.nn.evals.compute_oks" title="sleap.nn.evals.compute_oks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_oks</span></code></a> function for details.</p></li>
<li><p><strong>match_threshold</strong> – The threshold to use on oks scores when determining
which instances match between ground truth and predicted frames.</p></li>
<li><p><strong>user_labels_only</strong> – If False, predicted instances in the ground truth frame may be
considered for matching.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dict, keys are strings, values are metrics (floats or ndarrays).</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sleap.nn.evals.evaluate_model">
<span class="sig-prename descclassname"><span class="pre">sleap.nn.evals.</span></span><span class="sig-name descname"><span class="pre">evaluate_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="sleap.nn.config.training_job.html#sleap.nn.config.training_job.TrainingJobConfig" title="sleap.nn.config.training_job.TrainingJobConfig"><span class="pre">TrainingJobConfig</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels_gt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="sleap.nn.data.providers.html#sleap.nn.data.providers.LabelsReader" title="sleap.nn.data.providers.LabelsReader"><span class="pre">LabelsReader</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="sleap.io.dataset.html#sleap.io.dataset.Labels" title="sleap.io.dataset.Labels"><span class="pre">Labels</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="sleap.nn.model.html#sleap.nn.model.Model" title="sleap.nn.model.Model"><span class="pre">Model</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'test'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="sleap.io.dataset.html#sleap.io.dataset.Labels" title="sleap.io.dataset.Labels"><span class="pre">Labels</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/talmolab/sleap/blob/v1.4.1/sleap/nn/evals.py#L683-L773"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.evals.evaluate_model" title="Permalink to this definition">#</a></dt>
<dd><p>Evaluate a trained model and save metrics and predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cfg</strong> – The <code class="xref py py-obj docutils literal notranslate"><span class="pre">TrainingJobConfig</span></code> associated with the model.</p></li>
<li><p><strong>labels_gt</strong> – A <code class="xref py py-obj docutils literal notranslate"><span class="pre">LabelsReader</span></code> pipeline generator that reads the ground truth
data to evaluate or a <code class="xref py py-obj docutils literal notranslate"><span class="pre">Labels</span></code> object to be used as ground truth.</p></li>
<li><p><strong>model</strong> – The <a class="reference internal" href="sleap.nn.model.html#sleap.nn.model.Model" title="sleap.nn.model.Model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sleap.nn.model.Model</span></code></a> instance to evaluate.</p></li>
<li><p><strong>save</strong> – If True, save the predictions and metrics to the model folder.</p></li>
<li><p><strong>split_name</strong> – String name to append to the saved filenames.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>A tuple of <code class="xref py py-obj docutils literal notranslate"><span class="pre">(labels_pr,</span> <span class="pre">metrics)</span></code>.</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">labels_pr</span></code> will contain the predicted labels.</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">metrics</span></code> will contain the evaluated metrics given the predictions, or None if
the metrics failed to be computed.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sleap.nn.evals.find_frame_pairs">
<span class="sig-prename descclassname"><span class="pre">sleap.nn.evals.</span></span><span class="sig-name descname"><span class="pre">find_frame_pairs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels_gt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="sleap.io.dataset.html#sleap.io.dataset.Labels" title="sleap.io.dataset.Labels"><span class="pre">Labels</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels_pr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="sleap.io.dataset.html#sleap.io.dataset.Labels" title="sleap.io.dataset.Labels"><span class="pre">Labels</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_labels_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="sleap.instance.html#sleap.instance.LabeledFrame" title="sleap.instance.LabeledFrame"><span class="pre">LabeledFrame</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="sleap.instance.html#sleap.instance.LabeledFrame" title="sleap.instance.LabeledFrame"><span class="pre">LabeledFrame</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/talmolab/sleap/blob/v1.4.1/sleap/nn/evals.py#L61-L113"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.evals.find_frame_pairs" title="Permalink to this definition">#</a></dt>
<dd><p>Find corresponding frames across two sets of labels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>labels_gt</strong> – A <code class="xref py py-obj docutils literal notranslate"><span class="pre">sleap.Labels</span></code> instance with ground truth instances.</p></li>
<li><p><strong>labels_pr</strong> – A <code class="xref py py-obj docutils literal notranslate"><span class="pre">sleap.Labels</span></code> instance with predicted instances.</p></li>
<li><p><strong>user_labels_only</strong> – If False, frames with predicted instances in <code class="xref py py-obj docutils literal notranslate"><span class="pre">labels_gt</span></code> will
also be considered for matching.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of pairs of <code class="xref py py-obj docutils literal notranslate"><span class="pre">sleap.LabeledFrame`s</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">form</span> <span class="pre">`(frame_gt,</span> <span class="pre">frame_pr)</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sleap.nn.evals.load_metrics">
<span class="sig-prename descclassname"><span class="pre">sleap.nn.evals.</span></span><span class="sig-name descname"><span class="pre">load_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'val'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/talmolab/sleap/blob/v1.4.1/sleap/nn/evals.py#L776-L815"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.evals.load_metrics" title="Permalink to this definition">#</a></dt>
<dd><p>Load metrics for a model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_path</strong> – Path to a model folder or metrics file (.npz).</p></li>
<li><p><strong>split</strong> – Name of the split to load the metrics for. Must be <code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;train&quot;</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;val&quot;</span></code> or
<code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;test&quot;</span></code> (default: <code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;val&quot;</span></code>). Ignored if a path to a metrics NPZ file is
provided.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;vis.tp&quot;</span></code>: Visibility - True Positives</p></li>
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;vis.fp&quot;</span></code>: Visibility - False Positives</p></li>
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;vis.tn&quot;</span></code>: Visibility - True Negatives</p></li>
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;vis.fn&quot;</span></code>: Visibility - False Negatives</p></li>
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;vis.precision&quot;</span></code>: Visibility - Precision</p></li>
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;vis.recall&quot;</span></code>: Visibility - Recall</p></li>
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;dist.avg&quot;</span></code>: Average Distance (ground truth vs prediction)</p></li>
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;dist.p50&quot;</span></code>: Distance for 50th percentile</p></li>
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;dist.p75&quot;</span></code>: Distance for 75th percentile</p></li>
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;dist.p90&quot;</span></code>: Distance for 90th percentile</p></li>
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;dist.p95&quot;</span></code>: Distance for 95th percentile</p></li>
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;dist.p99&quot;</span></code>: Distance for 99th percentile</p></li>
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;dist.dists&quot;</span></code>: All distances</p></li>
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;dist.frame_idxs&quot;</span></code>: Frame indices corresponding to <code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;dist.dists&quot;</span></code></p></li>
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;dist.video_paths&quot;</span></code>: Video paths corresponding to <code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;dist.dists&quot;</span></code></p></li>
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;pck.mPCK&quot;</span></code>: Mean Percentage of Correct Keypoints (PCK)</p></li>
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;oks.mOKS&quot;</span></code>: Mean Object Keypoint Similarity (OKS)</p></li>
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;oks_voc.mAP&quot;</span></code>: VOC with OKS scores - mean Average Precision (mAP)</p></li>
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;oks_voc.mAR&quot;</span></code>: VOC with OKS scores - mean Average Recall (mAR)</p></li>
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;pck_voc.mAP&quot;</span></code>: VOC with PCK scores - mean Average Precision (mAP)</p></li>
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;pck_voc.mAR&quot;</span></code>: VOC with PCK scores - mean Average Recall (mAR)</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>The loaded metrics as a dictionary with keys</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sleap.nn.evals.match_frame_pairs">
<span class="sig-prename descclassname"><span class="pre">sleap.nn.evals.</span></span><span class="sig-name descname"><span class="pre">match_frame_pairs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frame_pairs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="sleap.instance.html#sleap.instance.LabeledFrame" title="sleap.instance.LabeledFrame"><span class="pre">LabeledFrame</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="sleap.instance.html#sleap.instance.LabeledFrame" title="sleap.instance.LabeledFrame"><span class="pre">LabeledFrame</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stddev</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.025</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_labels_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="sleap.instance.html#sleap.instance.Instance" title="sleap.instance.Instance"><span class="pre">Instance</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="sleap.instance.html#sleap.instance.PredictedInstance" title="sleap.instance.PredictedInstance"><span class="pre">PredictedInstance</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="sleap.instance.html#sleap.instance.Instance" title="sleap.instance.Instance"><span class="pre">Instance</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/talmolab/sleap/blob/v1.4.1/sleap/nn/evals.py#L353-L399"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.evals.match_frame_pairs" title="Permalink to this definition">#</a></dt>
<dd><p>Match all ground truth and predicted instances within each pair of frames.</p>
<p>This is a wrapper for <a class="reference internal" href="#sleap.nn.evals.match_instances" title="sleap.nn.evals.match_instances"><code class="xref py py-obj docutils literal notranslate"><span class="pre">match_instances()</span></code></a> but operates on lists of frames.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>frame_pairs</strong> – A list of pairs of <code class="xref py py-obj docutils literal notranslate"><span class="pre">sleap.LabeledFrame`s</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">form</span>
<span class="pre">`(frame_gt,</span> <span class="pre">frame_pr)</span></code>. These can be obtained with <a class="reference internal" href="#sleap.nn.evals.find_frame_pairs" title="sleap.nn.evals.find_frame_pairs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_frame_pairs()</span></code></a>.</p></li>
<li><p><strong>stddev</strong> – The expected spread of coordinates for OKS computation.</p></li>
<li><p><strong>scale</strong> – The scale for normalizing the OKS. If not set, the bounding box area will
be used.</p></li>
<li><p><strong>threshold</strong> – The minimum OKS between a candidate pair of instances to be
considered a match.</p></li>
<li><p><strong>user_labels_only</strong> – If False, predicted instances in the ground truth frame may be
considered for matching.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>A tuple of (<code class="xref py py-obj docutils literal notranslate"><span class="pre">positive_pairs</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">false_negatives</span></code>).</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">positive_pairs</span></code> is a list of 3-tuples of the form
<code class="xref py py-obj docutils literal notranslate"><span class="pre">(instance_gt,</span> <span class="pre">instance_pr,</span> <span class="pre">oks)</span></code> containing the matched pair of instances and
their OKS.</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">false_negatives</span></code> is a list of ground truth <a href="#id1"><span class="problematic" id="id2">`</span></a>sleap.Instance`s that could not be
matched.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sleap.nn.evals.match_instances">
<span class="sig-prename descclassname"><span class="pre">sleap.nn.evals.</span></span><span class="sig-name descname"><span class="pre">match_instances</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frame_gt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="sleap.instance.html#sleap.instance.LabeledFrame" title="sleap.instance.LabeledFrame"><span class="pre">LabeledFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_pr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="sleap.instance.html#sleap.instance.LabeledFrame" title="sleap.instance.LabeledFrame"><span class="pre">LabeledFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">stddev</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.025</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_labels_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="sleap.instance.html#sleap.instance.Instance" title="sleap.instance.Instance"><span class="pre">Instance</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="sleap.instance.html#sleap.instance.PredictedInstance" title="sleap.instance.PredictedInstance"><span class="pre">PredictedInstance</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="sleap.instance.html#sleap.instance.Instance" title="sleap.instance.Instance"><span class="pre">Instance</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/talmolab/sleap/blob/v1.4.1/sleap/nn/evals.py#L253-L350"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.evals.match_instances" title="Permalink to this definition">#</a></dt>
<dd><p>Match pairs of instances between ground truth and predictions in a frame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>frame_gt</strong> – A <code class="xref py py-obj docutils literal notranslate"><span class="pre">sleap.LabeledFrame</span></code> with ground truth instances.</p></li>
<li><p><strong>frame_pr</strong> – A <code class="xref py py-obj docutils literal notranslate"><span class="pre">sleap.LabeledFrame</span></code> with predicted instances.</p></li>
<li><p><strong>stddev</strong> – The expected spread of coordinates for OKS computation.</p></li>
<li><p><strong>scale</strong> – The scale for normalizing the OKS. If not set, the bounding box area will
be used.</p></li>
<li><p><strong>threshold</strong> – The minimum OKS between a candidate pair of instances to be
considered a match.</p></li>
<li><p><strong>user_labels_only</strong> – If False, predicted instances in the ground truth frame may be
considered for matching.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>A tuple of (<code class="xref py py-obj docutils literal notranslate"><span class="pre">positive_pairs</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">false_negatives</span></code>).</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">positive_pairs</span></code> is a list of 3-tuples of the form
<code class="xref py py-obj docutils literal notranslate"><span class="pre">(instance_gt,</span> <span class="pre">instance_pr,</span> <span class="pre">oks)</span></code> containing the matched pair of instances and
their OKS.</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">false_negatives</span></code> is a list of ground truth <a href="#id3"><span class="problematic" id="id4">`</span></a>sleap.Instance`s that could not be
matched.</p>
</p>
</dd>
</dl>
<div class="admonition-notes admonition">
<p class="admonition-title">Notes</p>
<p>This function uses the approach from the PASCAL VOC scoring procedure. Briefly,
predictions are sorted descending by their instance-level prediction scores and
greedily matched to ground truth instances which are then removed from the pool
of available instances.</p>
<p>Ground truth instances that remain unmatched are considered false negatives.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sleap.nn.evals.replace_path">
<span class="sig-prename descclassname"><span class="pre">sleap.nn.evals.</span></span><span class="sig-name descname"><span class="pre">replace_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">video_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_paths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/talmolab/sleap/blob/v1.4.1/sleap/nn/evals.py#L52-L58"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.evals.replace_path" title="Permalink to this definition">#</a></dt>
<dd><p>Replace video paths in unstructured video objects.</p>
</dd></dl>

</section>


                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sleap.nn.evals.compute_dist_metrics"><code class="docutils literal notranslate"><span class="pre">compute_dist_metrics()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sleap.nn.evals.compute_dists"><code class="docutils literal notranslate"><span class="pre">compute_dists()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sleap.nn.evals.compute_generalized_voc_metrics"><code class="docutils literal notranslate"><span class="pre">compute_generalized_voc_metrics()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sleap.nn.evals.compute_instance_area"><code class="docutils literal notranslate"><span class="pre">compute_instance_area()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sleap.nn.evals.compute_oks"><code class="docutils literal notranslate"><span class="pre">compute_oks()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sleap.nn.evals.compute_pck_metrics"><code class="docutils literal notranslate"><span class="pre">compute_pck_metrics()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sleap.nn.evals.compute_visibility_conf"><code class="docutils literal notranslate"><span class="pre">compute_visibility_conf()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sleap.nn.evals.evaluate"><code class="docutils literal notranslate"><span class="pre">evaluate()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sleap.nn.evals.evaluate_model"><code class="docutils literal notranslate"><span class="pre">evaluate_model()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sleap.nn.evals.find_frame_pairs"><code class="docutils literal notranslate"><span class="pre">find_frame_pairs()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sleap.nn.evals.load_metrics"><code class="docutils literal notranslate"><span class="pre">load_metrics()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sleap.nn.evals.match_frame_pairs"><code class="docutils literal notranslate"><span class="pre">match_frame_pairs()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sleap.nn.evals.match_instances"><code class="docutils literal notranslate"><span class="pre">match_instances()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sleap.nn.evals.replace_path"><code class="docutils literal notranslate"><span class="pre">replace_path()</span></code></a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By SLEAP Developers
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2019–2024, Talmo Lab.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>